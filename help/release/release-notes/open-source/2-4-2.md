---
title: Notas de versão do Magento Open Source 2.4.2
description: Saiba mais sobre novos recursos, melhorias, correções de erros e problemas conhecidos na versão 2.4.2 do Magento Open Source.
recommendations: noCatalog
exl-id: 01e90bcb-d43c-4daa-9669-44e3370102af
source-git-commit: 6896d31a202957d7354c3dd5eb6459eda426e8d7
workflow-type: tm+mt
source-wordcount: '12958'
ht-degree: 0%

---

# Notas de versão do Magento Open Source 2.4.2

O Magento Open Source 2.4.2 apresenta melhorias de desempenho e segurança, além de melhorias significativas na plataforma. Os aprimoramentos de segurança incluem a expansão do suporte para o atributo `SameSite` para todos os cookies. O Elasticsearch 7.9.x e o Redis 6.x agora são compatíveis.

Esta versão inclui mais de 280 novas correções para o código principal e 35 aprimoramentos de segurança. Ele inclui a resolução de quase 290 problemas do GitHub por membros da nossa comunidade. Essas contribuições da comunidade variam desde uma pequena limpeza do código principal até melhorias significativas no GraphQL.

Todos os problemas conhecidos identificados na versão 2.4.1 foram corrigidos nessa versão.

{{bics}}

## Aplique o AC-3022.patch para continuar oferecendo a DHL como transportadora

A DHL apresentou o schema versão 6.2 e descontinuará o schema versão 6.0 em breve. Adobe Commerce 2.4.4 e versões anteriores que suportam a integração DHL suportam apenas a versão 6.0. Os comerciantes que implantarem essas versões devem aplicar o `AC-3022.patch` o mais rápido possível para continuarem oferecendo a DHL como transportadora. Consulte o artigo da Base de conhecimento [Aplicar um patch para continuar oferecendo a DHL como transportadora](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) para obter informações sobre como baixar e instalar o patch.

## Patch de segurança disponível

Os comerciantes agora podem instalar correções de segurança com prazo confidencial sem aplicar as centenas de correções e aprimoramentos funcionais que uma versão trimestral completa oferece (por exemplo, 2.4.1-p1). O patch 2.4.0.12 (Pacote do compositor 2.4.1-p1) é um patch de segurança que fornece correções para vulnerabilidades que foram identificadas na versão anterior trimestral, a 2.4.1. Todos os hot fixes aplicados à versão 2.4.1 estão incluídos neste patch de segurança. (Um *hot fix* fornece uma correção para uma versão lançada que aborda um problema ou erro específico.)

Para obter informações gerais sobre patches de segurança, consulte [Introdução à Nova Versão do Patch de Segurança](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287). Para obter instruções sobre como baixar e aplicar patches de segurança (incluindo o patch 2.4.1-p1), consulte [Instalação rápida no local](../../../installation/composer.md). Os patches de segurança incluem apenas correções de bugs de segurança, não as melhorias de segurança adicionais incluídas no patch completo.

## Outras informações sobre a versão

Embora o código desses recursos esteja incluído nas versões trimestrais, vários desses projetos (por exemplo, Progressive Web Applications (PWA) Studio) também são lançados independentemente. As correções de erros para esses projetos estão documentadas nas informações de versão separadas e específicas do projeto, disponíveis na documentação de cada projeto.

## Destaques

Procure os seguintes destaques nesta versão.

### Aprimoramentos substanciais de segurança

Esta versão inclui mais de 35 correções de segurança e melhorias na segurança da plataforma. Todas as correções de segurança tiveram backport para 2.4.1-p1 e 2.3.6-p1.

#### Mais de 35 aprimoramentos de segurança que ajudam a fechar as vulnerabilidades de execução remota de código (RCE) e criação de script entre sites (XSS)

Nenhum ataque confirmado relacionado a esses problemas ocorreu até o momento. No entanto, certas vulnerabilidades podem ser potencialmente exploradas para acessar informações do cliente ou assumir o controle de sessões de administrador. A maioria desses problemas exige que um invasor obtenha acesso ao Administrador primeiro. Como resultado, lembramos você de tomar todas as medidas necessárias para proteger seu Administrador, incluindo, mas não limitado a, esses esforços: incluir na lista de permissões de IP, [autenticação de dois fatores](https://developer.adobe.com/commerce/testing/functional-testing-framework/two-factor-authentication/), uso de uma VPN, uso de um local exclusivo em vez de `/admin` e boa higiene de senha. Consulte o [Boletim de Segurança do Adobe](https://helpx.adobe.com/br/security/products/magento/apsb21-08.html) para ver uma discussão sobre esses problemas corrigidos.

#### Aprimoramentos adicionais de segurança

Os aprimoramentos de segurança para esta versão incluem:

* Todos os cookies principais agora oferecem suporte ao atributo `SameSite`.

* O aplicativo agora exibe mensagens que identificam conteúdo potencialmente mal-intencionado nos campos de descrição do produto e da categoria quando o usuário tenta salvar valores nesses campos.

* As operações do sistema de arquivos nos componentes foram padronizadas e fortalecidas para evitar uploads mal-intencionados.

* As violações da Política de Segurança de Conteúdo (CSP) principal foram corrigidas.

{{cve-notice}}

### Melhorias na infraestrutura

Esta versão inclui aprimoramentos na qualidade principal, que melhoram a qualidade da Estrutura e estas áreas funcionais: Conta do cliente, Catálogo, CMS, OMS, Importação/Exportação, Promoções e Direcionamento e Carrinho e Check-out.

### Aprimoramentos na plataforma

* Agora há suporte para o [**Elasticsearch 7.9.x**](../../../installation/system-requirements.md). Embora seja recomendável executar o Elasticsearch 7.9.x, a versão 2.4.x permanece compatível com o Elasticsearch 7.4.x. <!-- MC-36867-->

* A versão 2.4.2 foi testada com [Verniz 6.4](../../../installation/system-requirements.md). A versão 2.4.x permanece compatível com o Varnish 6.x.

* Agora há suporte para o [**Redis 6.x**](../../../installation/system-requirements.md). A versão 2.4.x permanece compatível com o Redis 5.x. <!-- MC-34853-->

* A versão 2.4.2 agora é compatível com o **Composer 2.x**. Recomendamos que os comerciantes migrem para o Composer 2.x. Embora você possa instalar esta versão usando o Composer 1.x, o Composer 1.x logo chegará ao fim da vida útil. Para obter uma visão geral dos recursos do Composer 2.x, consulte [O Composer 2.0 já está disponível!](https://blog.packagist.com/composer-2-0-is-now-available/)

A capacidade de configurar uma instalação para usar um banco de dados dividido foi descontinuada nesta versão. Os comerciantes que atualmente usam o banco de dados dividido devem começar a planejar a reversão para um único banco de dados ou a migração para um único banco de dados ou usar uma abordagem alternativa. Consulte a publicação [Deprecation of split database no Magento Open Source](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) DevBlog para obter uma visão geral desse problema.  Consulte [Reverter de um banco de dados dividido para um único banco de dados](../../../configuration/storage/revert-split-database.md) para obter instruções de migração.

### Aprimoramentos de desempenho

Esta versão inclui aprimoramentos de código que aumentam o desempenho da API e o tempo de resposta do administrador para implantações com catálogos grandes. Várias melhorias de escalabilidade permitem que a versão 2.4.2 ofereça suporte nativo a catálogos complexos até 20 vezes maior do que nas versões anteriores.

### Integração do Adobe Stock

Esta versão inclui a Integração do Adobe Stock v2.1.1.

### GraphQL

Esta versão inclui a cobertura da GraphQL para os seguintes recursos:

* Adicionado suporte para [listas de comparação](https://developer.adobe.com/commerce/webapi/graphql/schema/products/queries/compare-list/). Os compradores podem [criar](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/create-compare-list/) e [excluir](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/delete-compare-list/) listas de comparação e [adicionar](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/add-products-to-compare-list/) e [remover](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/remove-from-compare-list/) itens para as listas de comparação. Além disso, os compradores que criam uma lista de comparação como convidado podem fazer logon como cliente e [manter](https://developer.adobe.com/commerce/webapi/graphql/schema/customer/mutations/assign-compare-list/) suas listas de comparação.

* Adicionada a mutação [`generateCustomerTokenAsAdmin`](https://developer.adobe.com/commerce/webapi/graphql/schema/customer/mutations/generate-token-as-admin/) e atualizado o objeto `Customer` para oferecer suporte à assistência à compra remota.

* Adição de suporte à localização nas lojas para suportar tarefas como alteração de idiomas, carrinhos e moedas. <!-- MC-37801-->

* Suporte adicionado para uniões na GraphQL. [GitHub-29425](https://github.com/magento/magento2/issues/29425) <!-- ENGCOM-8291 -->

* O esquema do GraphQL foi aprimorado para otimizar a recuperação de dados de produtos para produtos configuráveis com muitas variantes. <!-- MC-36138-->

* As IDs de objeto de tipo inteiro foram substituídas em favor de `uid` atributos de ID de tipo. <!-- MC-36346-->

* Adição do atributo `staging` ao [`ProductInterface`](https://developer.adobe.com/commerce/webapi/graphql/schema/products/interfaces/attributes/) e [`CategoryInterface`](https://developer.adobe.com/commerce/webapi/graphql/schema/products/interfaces/category/) para determinar se um produto é preparado e exibir suas informações de campanha associadas. <!-- MC-33897-->

Consulte o [Guia do Desenvolvedor do GraphQL](https://developer.adobe.com/commerce/webapi/graphql/) para obter detalhes sobre esses aprimoramentos.

### PWA Studio

Esta versão do PWA Studio inclui:

* Internacionalização e localização. O Venia agora oferece suporte para vários idiomas e moedas.

* Estrutura de extensibilidade aprimorada para oferecer suporte a alterações de código por meio de extensões.

* Componentes iniciais para recursos relacionados à Minha Conta, como Lista de Desejos, Pagamentos Salvos, Catálogo de Endereços e Histórico de Pedidos.

* Várias otimizações de desempenho e correções de erros.

Para obter informações sobre aprimoramentos e correções de erros, consulte [versões do PWA Studio](https://github.com/magento/pwa-studio/releases). Consulte [compatibilidade](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) para obter uma lista de versões do PWA Studio e suas versões compatíveis.

### Galeria de mídia

**Novos Recursos de Função para Galeria de Mídia**. Esta versão oferece aos comerciantes a capacidade de limitar o acesso do administrador somente à galeria de Mídia e controlar quem pode executar estas ações:

* Inserir ativos de mídia no conteúdo

* Fazer upload de ativos

* Editar detalhes de ativos

* Excluir ativos da Galeria de mídia

* Gerenciar estrutura de pastas.

**Imagens otimizadas para a Web no conteúdo**. Os comerciantes agora podem usar [representação de imagem otimizada para a Web](https://experienceleague.adobe.com/pt-br/docs/commerce-admin/content-design/wysiwyg/gallery/media-gallery-image-optimization) em conteúdo, em vez de imagens de alta resolução. A imagem original permanece não modificada na Galeria de mídia e a representação da imagem é gerada dinamicamente quando a imagem é inserida no conteúdo.

### Quadro de testes funcionais (MFTF)

O MFTF 3.2.1 já está disponível. Esta versão introduz tolerância a erros na geração de testes e conjuntos de testes. Aprimoramentos adicionais e correções de erros estão descritos no [Log de alterações da estrutura de teste funcional](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

### Extensões desenvolvidas pelo fornecedor

Consulte os seguintes artigos para obter atualizações sobre recursos e alterações desta versão:

* [Pagamento do Amazon](https://commercemarketplace.adobe.com//amzn-amazon-pay-magento-2-module.html)

* [Braintree](https://experienceleague.adobe.com/pt-br/docs/commerce-admin/stores-sales/payments/braintree)

* [Nuvem do Engajamento Digital](https://commercemarketplace.adobe.com//dotdigital-dotdigital-magento2-os-package.html)

* [Klarna](https://commercemarketplace.adobe.com//klarna-m2-klarna.html)

* [Vertex Cloud](https://commercemarketplace.adobe.com//vertexinc-vertex-tax-module.html)

* [Análises de produto do Yotpo](../../../upgrade/modules/upgrade.md)

### Aprimoramentos de suporte ao AWS S3

O suporte ao Amazon Simple Storage Service (AWS S3) foi aprimorado para incluir suporte para:

* Armazenamento de objetos e extensibilidade futura

* [Armazenando arquivos de mídia](../../../configuration/remote-storage/remote-storage.md) no AWS S3

## Problemas corrigidos

Corrigimos centenas de problemas no código principal 2.4.2.

### Instalação, atualização, implantação

<!-- MC-38429-->

* A capacidade de configurar uma instalação para usar um banco de dados dividido foi descontinuada nesta versão. Consulte a [Descontinuação da funcionalidade de banco de dados dividido na publicação do DevBlog do Magento Open Source](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187).

<!-- MC-36472-->

* Os comerciantes agora podem atualizar com êxito uma implantação do Open Source que executa MySQL 8.x para uma implantação do Commerce. Anteriormente, o aplicativo lançava uma exceção quando `AUTO_INCREMENT` valores eram revertidos para valores iniciais de todas as tabelas em que `row_id` era adicionado durante a atualização.

<!-- ENGCOM-7280 -->

* O aplicativo agora exibe uma mensagem de erro que identifica o caminho usado para criar o patch se ocorrer um erro durante a execução do `bin/magento/setup:db:generate-patch`. [GitHub-27523](https://github.com/magento/magento2/issues/27523)

<!-- ENGCOM-8029 -->

* Os caches `block_html`, `full_page` e `layout` agora estão desabilitados conforme esperado após a execução de `bin/magento/setup:upgrade`.  [GitHub-28186](https://github.com/magento/magento2/issues/28186)

<!-- ENGCOM-8184 -->

* A versão mínima necessária do PHP em `bootstrap.php` foi atualizada. [GitHub-30004](https://github.com/magento/magento2/issues/30004)

<!-- MC-38788-->

* Agora você pode executar `bin/magento/setup:upgrade` após a instalação dos dados de exemplo. Anteriormente, quando você tentou executar `bin/magento/setup:upgrade`, o aplicativo exibia este erro: `unable to apply data patch magento\catalogrulesampledata\setup\patch\data\installcatalogrulesampledata for module magento_catalogrulesampledata`. O aplicativo também exibiu este erro no log do sistema: `main.ERROR: Sample Data error: Unable to unserialize value. Error: Syntax error`. [GitHub-30685](https://github.com/magento/magento2/issues/30685)

<!-- MC-36785-->

* Agora é possível definir uma chave de API do YouTube na linha de comando, conforme esperado. Anteriormente, o aplicativo retornava este erro quando você tentava executar `bin/magento config:sensitive:set catalog/product_video/youtube_api_key`: `There are no sensitive configurations to fill`.

<!-- ENGCOM-8163 -->

* O aplicativo agora respeita os valores `maxMessages` definidos em `queue_consumer.xml`. Anteriormente, o aplicativo usava apenas os valores de configuração de implantação. [GitHub-29522](https://github.com/magento/magento2/issues/29522)

<!-- ENGCOM-8243 -->

* A geração de URL para um novo armazenamento agora funciona como esperado quando o armazenamento é criado usando `bin/magento setup:config:import`. Anteriormente, as substituições de URL não eram geradas em ambientes de produção. [GitHub-30025](https://github.com/magento/magento2/issues/30025)

<!-- ENGCOM-8230 -->

* O aplicativo não lança mais um erro quando você tenta alterar o `backend-frontname` usando o contêiner `ssh` após instalar o Magento Open Source. [GitHub-26762](https://github.com/magento/magento2/issues/26762)

<!-- ENGCOM-8230 -->

* O aplicativo não exibe mais esta pergunta quando você executa o `bin/magento setup:install` para se conectar ao banco de dados existente: `Overwrite the existing configuration for db-ssl-verify?[Y/n]`. [GitHub-29612](https://github.com/magento/magento2/issues/29612)

### Integração do Adobe Stock

<!-- ENGCOM-8020-->

* Adicionado suporte para leitura de `exif_image.png` ou `exif-image.jpeg` metadados. [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8194 8094 8147-->

* O conteúdo exibido ao clicar no marcador Exibição padrão da Galeria de mídia não é mais filtrado. Anteriormente, o modo de exibição padrão continha um filtro aplicado do aplicador `url-filter`. [GitHub-1813](https://github.com/magento/adobe-stock-integration/issues/1813), [GitHub-1789](https://github.com/magento/adobe-stock-integration/issues/1789), [GitHub-1780](https://github.com/magento/adobe-stock-integration/issues/1780)

<!-- ENGCOM-8070 -->

* A lógica foi removida do controlador (`Magento\Cms\Controller\Adminhtml\Wysiwyg\Images\OnInsert::execute()`) do WYSIWYG OnInsert e adicionada ao modelo `Model\Wysiwyg\Images\PrepareImage::execute()`. [GitHub-1504](https://github.com/magento/adobe-stock-integration/issues/1504)

<!-- ENGCOM-8081 -->

* A emulação de área foi removida do comando `media-content:sync` (`\Magento\MediaContentSynchronization\Console\Command\Synchronize::execute`). [GitHub-1784](https://github.com/magento/adobe-stock-integration/issues/1784)

### Analytics

<!-- MC-37137-->

* Os Relatórios avançados agora funcionam como esperado em vários ambientes no mesmo domínio. Anteriormente, os arquivos CSV gerados pelos Relatórios avançados falhavam porque as aspas duplas eram evitadas com barras invertidas em vez de com outras aspas duplas, conforme exigido pelo padrão CSV RFC4180.

<!-- MC-35996-->

* O trabalho `analytics_collect_data` agora é executado com êxito ao usar a porta padrão ou não padrão para se conectar ao MySQL em `env.php`. Anteriormente, o `analytics_collect_data` exibia um erro quando você usava a porta não padrão.

<!-- MC-35407-->

* Os arquivos CSV gerados por `analytics_collect_data` agora são escapados corretamente. Anteriormente, esses arquivos não eram gerados com o escape correto, o que impedia a geração de relatórios de Inventário.

### Braintree

* Os compradores agora podem usar o Apple Pay para fazer um pedido de produtos virtuais com êxito. Anteriormente, o aplicativo exibia este erro: `There are no shipping methods available for you right now. Please try again or use an alternative payment method`.

* O método de pagamento padrão do Check-out expresso do PayPal agora funciona conforme esperado com o método de pagamento do Cartão de Crédito Braintree. Anteriormente, o aplicativo não exibia o botão **PayPal** quando o método de pagamento com Cartão de Crédito da Braintree era habilitado.

### Produtos do pacote

<!-- MC-34063-->

* O aplicativo não define mais os preços dos itens filho do produto de pacote de preço fixo entre aspas.

<!-- MC-38050-->

* A classificação de preços agora funciona conforme esperado quando os produtos de pacote incluem produtos indisponíveis. Anteriormente, a classificação do preço em ordem decrescente não exibia os produtos em ordem decrescente de preço.

<!-- MC-38576-->

* O aplicativo agora aplica automaticamente uma quantidade padrão de 1 para opções de pacote de produtos quando muitas opções existem. Anteriormente, os comerciantes tinham que atribuir manualmente uma quantidade padrão a cada opção.

<!-- ENGCOM-8159 -->

* A página de criação da fatura do pedido agora exibe os produtos secundários para produtos de pacote conforme esperado. [GitHub-27350](https://github.com/magento/magento2/issues/27350)

<!-- MC-38460 -->

* O aplicativo agora atribui preços de produtos corretos quando você recompra produtos simples que fazem parte de um pacote de produtos com um preço personalizado. Anteriormente, a definição de um preço personalizado em um pacote de produtos resultava em preços incorretos em produtos simples anexados quando resolicitados. [GitHub-30343](https://github.com/magento/magento2/issues/30343)

<!-- MC-30348 -->

* Chamar o POST `/V1/order/{orderId}/ship` para enviar um pedido que contém um produto de pacote agora marca o pedido como concluído conforme esperado. Anteriormente, o aplicativo exibia esta mensagem de erro: `You can't create a shipment without products`. [GitHub-9762](https://github.com/magento/magento2/issues/9762)

### Carrinho e check-out

<!-- MC-34264-->

* O avaliador de método de envio agora funciona conforme esperado quando atributos de endereço personalizados estão presentes na etapa de envio do fluxo de trabalho de finalização. Anteriormente, o aplicativo exibia esta mensagem de erro: `{"message":"Error occurred during \"custom_attributes\" processing. A custom attribute is specified with a missing attribute code. Verify the code and try again."}` [GitHub-27505](https://github.com/magento/magento2/issues/27505)

<!-- MC-35783-->

* O aplicativo agora exibe a mensagem `You have no items in your shopping cart` no minicarrinho como esperado quando um comprador remove o único item em seu carrinho. Anteriormente, os dados do carrinho não eram atualizados para `checkout/cart/removeFailed` quando um comprador removia o único item, e o aplicativo exibia esta mensagem: `1 product requires your attention`.

<!-- MC-36088-->

* O aplicativo não exibe mais o custo de envio de um pedido para um método de envio não aplicável. Anteriormente, o aplicativo exibia um preço de 0 para um método de envio não aplicável no workflow de finalização da compra.

<!-- MC-36598-->

* O endereço de cobrança padrão de um cliente agora é selecionado quando a caixa de seleção **Meu endereço de cobrança e de remessa são iguais** no fluxo de trabalho de check-out não está selecionada.

<!-- MC-37351-->

* O conteúdo do carrinho não é mais perdido quando um comprador muda de uma loja para outra em um domínio diferente.

<!-- MC-38000-->

* Os compradores agora podem concluir com êxito um pedido usando Check-out com vários endereços ao usar vários métodos de envio. Anteriormente, o aplicativo exibia este erro: `There has been an error processing your request`. [GitHub-30197](https://github.com/magento/magento2/issues/30197)

<!-- MC-38048-->

* O aplicativo agora exibe o país padrão correto na página de remessa do fluxo de trabalho de check-out quando o comprador altera a exibição da loja do carrinho de compras.

<!-- MC-38309-->

* O aplicativo agora exclui a sessão atual ao limpar as sessões do cliente após uma redefinição de senha pós-logout quando um comprador convidado está conectado. Anteriormente, o aplicativo esvaziava o carrinho de compras quando o comprador redefinia a senha.

<!-- MC-36884-->

* O aplicativo agora exibe o país padrão correto para uma exibição de loja quando um comprador altera a exibição da loja no carrinho de compras. Anteriormente, quando a visualização de loja era alterada no carrinho, o país padrão estava incorreto.

<!-- MC-38746-->

* As chamadas redundantes para o endpoint `/rest/V1/guest-carts/cart_id/totals-information` no carrinho foram removidas, o que melhorou o desempenho do carrinho. Anteriormente, quando um comprador adicionava um produto ao carrinho e, em seguida, visualizava o carrinho, o aplicativo chamava o método `collectAddressTotals` várias vezes.

<!-- MC-38833-->

* O aplicativo não exibe mais o campo **Região** para um país no fluxo de trabalho de check-out quando a configuração **Permitir para Escolher Estado se for Opcional para o País** está desabilitada. [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- MC-38813-->

* O aplicativo não repete mais um endereço de envio no fluxo de trabalho de finalização da loja quando um pedido é reordenado pelo administrador.

<!-- MC-38814-->

* Correção de problemas com o design de `AdminMediaGalleryInsertLargeImageFileSizeTest`.

<!-- MC-37321-->

* Todos os novos registros na tabela `quote` para convidados agora recebem um valor 1 na `customer_is_guest field`. Anteriormente, para cada novo convidado que adicionava um produto ao carrinho, o registro recebia um 0 no campo `quote.customer_is_guest`.

<!-- ENGCOM-8091 -->

* O botão **Enviar** na seção Revisar e Pagamentos do fluxo de trabalho de check-out foi movido para dentro de `<form id="purchaseorder-form"...></form>`, o que torna possível o envio implícito de formulários sem alterar qualquer JavaScript. [GitHub-27925](https://github.com/magento/magento2/issues/27925)

<!-- ENGCOM-8428 -->

* O aplicativo não exibe mais o campo **Região** no fluxo de trabalho de check-out quando a configuração **Permitir para Escolher Estado se for Opcional para o País** está desabilitada. [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- ENGCOM-8442 -->

* O aplicativo agora atualiza corretamente o subtotal do item do carrinho quando um comprador clica em **Atualizar carrinho de compras** ao fazer check-out com vários endereços. [GitHub-30408](https://github.com/magento/magento2/issues/30408)

<!-- ENGCOM-8283 -->

* O aplicativo não lança mais uma exceção quando existem `config.xml` nós para métodos de pagamento não instalados no momento. Anteriormente, o aplicativo lançava uma exceção durante o check-out. [GitHub-29555](https://github.com/magento/magento2/issues/29555)

<!-- ENGCOM-8215 -->

* O aplicativo agora renderiza corretamente nomes de produtos que contêm caracteres especiais no minicarrinho. [GitHub-29075](https://github.com/magento/magento2/issues/29075)

<!-- ENGCOM-8308 -->

* O aplicativo agora define o pacote de desconto correto para a taxa de tabela. Anteriormente, o aplicativo não aplicava uma regra de carrinho que definia um desconto no carrinho ao calcular a taxa da tabela. [GitHub-30169](https://github.com/magento/magento2/issues/30169)

### Regra de preço do carrinho

* As regras de preço do carrinho agora são aplicadas conforme esperado quando os subtotais do pedido são calculados sem incorporar imposto. A nova opção `Subtotal (Incl. Tax)` foi adicionada como uma condição de regra de preço de carrinho.

<!-- MC-37884-->

* A aplicação de uma regra de preço com um cupom usando o GraphQL agora funciona como esperado quando a ação **Desconto de valor fixo para carrinho inteiro** é usada.

### Catálogo

<!-- MC-34100-->

* O aplicativo agora exibe todos os produtos reativados na loja, conforme esperado. Anteriormente, quando um produto era desativado e depois reativado, o aplicativo não exibia o produto até que o cache da página Verniz fosse limpo ou a loja fosse reindexada, pois o cache da página não era invalidado após a reativação de um produto.

<!-- MC-37745-->

* A reindexação parcial de catálogos grandes agora funciona conforme esperado. Anteriormente, os produtos desapareciam aleatoriamente da página de categoria da loja durante a reindexação com o indexador parcial `catalogsearch_fulltext`.

<!-- MC-35123-->

* Os compradores agora podem resolicitar um pedido faturado de um produto com opções personalizáveis, conforme esperado. Anteriormente, o aplicativo exibia este erro quando um comprador tentava reordenar: `{"0":"The product's required option(s) weren't entered. Make sure the options are entered and try again`.

<!-- MC-35212-->

* Agora você pode definir com êxito a configuração **Layout** na página Design da categoria como **Nenhuma atualização de layout**. Anteriormente, o aplicativo revertia para **Categoria - LarguraTotal** quando você atribuiu o valor **Nenhuma atualização de layout**.

<!-- MC-35490-->

* Problemas com a ordem de classificação de produtos na loja foram resolvidos. Anteriormente, quando o aplicativo indexava os preços dos produtos, ele ocasionalmente definia o `min_price` e o `max_price` de um produto configurável como 0 na tabela `catalog_product_index_price`, o que afetava a ordem de classificação de preço na loja.

<!-- MC-35608-->

* O aplicativo agora atualiza com êxito os atributos rotulados como `Product Type`. Anteriormente, como o atributo `product_type` estava reservado no código, o aplicativo exibia esta mensagem quando você tentava atualizar um atributo `Product Type`: `An attribute with the same code (product_type) already exists.`

<!-- MC-36214-->

* O aplicativo não altera mais a posição de um vídeo carregado na seção Imagens e vídeos da página de detalhes do produto quando você o salva. Anteriormente, um valor de índice era atribuído à nova posição de imagem (posição na lista) e, se as posições de imagem existentes não estivessem alinhadas aos seus valores de índice, a nova imagem era colocada incorretamente na lista.

<!-- MC-36548-->

* A funcionalidade **Adicionar ao carrinho** agora funciona conforme esperado sempre que o botão **Adicionar ao carrinho** está disponível para clicar. Anteriormente, se você clicava nesse botão várias vezes enquanto aguardava o carregamento de uma página de produto, o aplicativo exibia o seguinte erro: `Invalid Form Key. Please refresh the page`.

<!-- MC-37006 36835-->

* O aplicativo não libera mais o cache de categoria quando um comerciante adiciona ou remove produtos desativados de ou para uma categoria. Anteriormente, o aplicativo liberava o cache para categorias relacionadas apesar do status do produto. As categorias também não eram atribuídas quando uma categoria era salva, o que resultava na liberação do cache de categorias.

<!-- MC-37347-->

* A filtragem de produtos de catálogo no escopo **Todas as exibições de loja** agora funciona corretamente. Anteriormente, os produtos com status `Enabled` ou `Disabled` eram exibidos na grade ao filtrar apenas produtos habilitados ou desabilitados.

<!-- MC-38038-->

* A reindexação parcial não resulta mais em produtos perdidos e categorias vazias.

<!-- MC-38315-->

* A reorganização agora funciona como esperado quando **Usar Calendário do JavaScript** está habilitado (**Lojas** > **Configuração** > **Catálogo** > **Opções Personalizadas de Data e Hora**). Anteriormente, quando esta configuração era habilitada, o aplicativo exibia este erro quando você tentava reordenar o pedido feito anteriormente do Administrador: `Please specify date required option(s)`.

<!-- MC-38719-->

* O aplicativo agora exibe a moeda correta em implantações de vários sites durante a criação do preço da camada.

<!-- MC-38914-->

* Os atributos personalizados de imagem do produto agora são escapados corretamente. O atributo `data-src` tem o mesmo valor que o atributo `src`, conforme esperado. Anteriormente, os símbolos especiais de URL eram escapados.

<!-- MC-37665-->

* Atualizar uma categoria por meio da API REST não desabilita mais a configuração **Usar valor padrão** nos atributos Habilitar categoria, Incluir no menu e Chave de URL.

<!-- MC-35363-->

* Salvar uma categoria agora libera somente o cache de blocos relacionado a essa categoria. Anteriormente, o aplicativo liberava o cache para todos os blocos de categoria.

<!-- MC-30626-->

* O preço de uma opção personalizada com um preço percentual agora é convertido conforme esperado na moeda base da loja ativa em implantações de várias lojas. Anteriormente, o preço de uma opção personalizada com um preço percentual era convertido incorretamente. [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- MC-38890-->

* O aplicativo agora recria imagens com êxito, e essas imagens ficam visíveis no Administrador como esperado sempre que um comerciante envia dados da galeria de mídia usando o POST `rest/all/V1/products`. Anteriormente, o aplicativo recriava as imagens, mas as excluía quando um comerciante enviava dados da galeria de mídia via POST `rest/all/V1/products` se as imagens fossem excluídas em `pub/media`, mas ainda havia registros na mídia que continham registros para essas imagens. Como resultado, o comerciante viu apenas espaços reservados no Administrador, pois as imagens foram criadas e excluídas durante o processo de atualização.

<!-- MC-36903-->

* Os registros agora são excluídos conforme esperado quando você desatribui um item de um site. Anteriormente, as imagens eram duplicadas quando o POST `rest/all/V1/products` era executado.

<!-- MC-38413-->

* A chamada `/V1/categories/{categoryId}/products` agora retorna uma lista de todos os produtos que pertencem à categoria pai, conforme esperado. Anteriormente, se um produto pertencia a mais de uma subcategoria da categoria principal, o aplicativo exibia este tipo de erro: `Internal Error. Details are available in the application log file. Report ID: webapi-5f8579e37db54`.  [GitHub-30461](https://github.com/magento/magento2/issues/30461)

<!-- MC-32996-->

* O ponto de extremidade REST `/V1/products/attributes/:attributeCode/options` agora dá suporte à atualização de uma opção de atributo existente.

<!-- MC-30626 ENGCOM-8475-->

* O preço de uma opção personalizada com um preço percentual agora é convertido conforme esperado na moeda base da loja ativa em implantações de várias lojas. Anteriormente, o preço de uma opção personalizada com um preço percentual era convertido incorretamente. [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- ENGCOM-8395 -->

* Os comerciantes agora podem salvar com sucesso um novo atributo durante a criação do produto. Anteriormente, o aplicativo não salvava o atributo e redirecionava o comerciante para a página inicial de exibição da loja quando tentava salvar o atributo. [GitHub-30362](https://github.com/magento/magento2/issues/30362)

<!-- ENGCOM-7997 -->

* As grades de produtos nas páginas **Vendas** > **Pedidos** e **Catálogo** > **Produtos** agora listam todas as lojas relevantes, não apenas a mais recente. [GitHub-29267](https://github.com/magento/magento2/issues/29267)

<!-- ENGCOM-6698 -->

* O repositório de produtos agora usa `store_id` quando disponível para salvar valores de atributos para um produto existente.  Anteriormente, a classe de repositório de produtos substituía a ID da loja de produtos e sempre atribuía a ID da loja padrão. [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### Regra de catálogo

<!-- MC-35065-->

* Agora as regras de preço de catálogo funcionam conforme esperado com opções personalizadas nas páginas de detalhes do produto. Anteriormente, os preços dos produtos nessa página não refletiam as regras de preço de catálogo aplicáveis. [GitHub-22856](https://github.com/magento/magento2/issues/22856)

<!-- MC-34265-->

* Os caches de produtos e catálogos agora expiram conforme programado. Anteriormente, os caches expiravam diariamente porque `сron` executava a tarefa `catalogrule_apply_all` uma vez por dia, que reindexava todas as regras de catálogo e indexadores dependentes e limpava o cache para todos os produtos e categorias.

### Cleanup

#### Limpeza de gramática e erro de digitação

<!-- ENGCOM-7967 -->

* O título da página Falha do pedido foi revisado para fins de precisão. Anteriormente, este título da página era: **Recebemos seu pedido!**.  [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-8101 -->

* Espaços desnecessários removidos em `app/code/Magento/Contact/view/frontend/templates/form.phtml`. [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-7716 -->

* Correção de um erro de digitação na mensagem de ajuda para o subcomando `bin/magento/setup:config:set`.  [GitHub-28802](https://github.com/magento/magento2/issues/28802)

<!-- ENGCOM-8058 -->

* Gramática corrigida no PHPDoc para o arquivo `framework/Registry.php`. [GitHub-29661](https://github.com/magento/magento2/issues/29661)

<!-- ENGCOM-8273 -->

* Espaço em branco irrelevante removido de `app/code/Magento/Catalog/Helper/Product/View.php`. [GitHub-30601](https://github.com/magento/magento2/issues/30601)

<!-- ENGCOM-8181 -->

* Correção de um erro de digitação em um nome de função em `app/code/Magento/Ui/view/base/web/js/form/element/ui-select.js`. [GitHub-29987](https://github.com/magento/magento2/issues/29987)

<!-- ENGCOM-8478 -->

* Correção da pluralização de &quot;item&quot; no minicarrinho e no resumo do pedido de checkout. [GitHub-29920](https://github.com/magento/magento2/issues/29920)

<!-- ENGCOM-8309 -->

* Espaço em branco removido em elementos em linha nos filtros de navegação em camadas de marcação. [GitHub-30448](https://github.com/magento/magento2/issues/30448)

<!-- ENGCOM-8056 -->

* `rl` foi corrigido para `url` em `\Magento\Framework\Filter\Template\Tokenizer\Parameter`. [GitHub-29185](https://github.com/magento/magento2/issues/29185)

#### Limpeza de código

<!-- MC-37922-->

* Uma marca HTML `<br>` irrelevante foi removida da área de mensagem Verificar Dados da página **Sistema** > **Importar**.

<!-- ENGCOM-8028 -->

* `ChangeQuoteControl` foi refatorado. [GitHub-29673](https://github.com/magento/magento2/issues/29673)

<!-- ENGCOM-8027 -->

* `AccessChangeQuoteControl` e seus testes de unidade foram refatorados. [GitHub-29672](https://github.com/magento/magento2/issues/29672)

<!-- ENGCOM-8053 -->

* Corrigido o estilo de código da declaração de tipo de retorno em `app/code/Magento/Captcha/CustomerData/Captcha.php`. [GitHub-29712](https://github.com/magento/magento2/issues/29712)

<!-- ENGCOM-8288 -->

* Correção da posição da lista de botões na página Novo Atributo.

<!-- ENGCOM-8315 -->

* Adição da classe de bloco correta para o exemplo de referência `viewModel` de front-end para a classe `\Magento\Framework\View\Element\Template`. [GitHub-30450](https://github.com/magento/magento2/issues/30450)

<!-- ENGCOM-8090 -->

* Um conjunto de campos redundante no formulário Regra de venda foi removido. [GitHub-29599](https://github.com/magento/magento2/issues/29599)

<!-- ENGCOM-8448 -->

* Código desnecessário foi removido do modelo `hierarchy/edit.phtml`.

<!-- ENGCOM-8446 -->

* Comentário PHPdoc corrigido em `app/code/Magento/CatalogImportExport/Model/Export/Product.php`. [GitHub-30833](https://github.com/magento/magento2/issues/30833)

<!-- ENGCOM-8277 -->

* A anotação docblock da mensagem `PublisherInterface` foi corrigida. [GitHub-30190](https://github.com/magento/magento2/issues/30190)

<!-- ENGCOM-8264 -->

* Argumentos corrigidos no método `getStatusByState`. [GitHub-30173](https://github.com/magento/magento2/issues/30173)

<!-- ENGCOM-8235 -->

* Descrição de método corrigida em `app/code/Magento/Quote/Model/Cart/Totals/ItemConverter.php`. [GitHub-30125](https://github.com/magento/magento2/issues/30125)

<!-- ENGCOM-8242 -->

* Remoção de atribuições de variáveis redundantes na mesma linha em vários arquivos. [GitHub-30133](https://github.com/magento/magento2/issues/30133)

<!-- ENGCOM-8263 -->

* Alterado `@param string $attribute` para `@param AbstractAttribute|string[]|string $attribute` em `EntityAbstract.php`. [GitHub-30191](https://github.com/magento/magento2/issues/30191)

<!-- ENGCOM-8142 -->

* Marcas inválidas (por exemplo, `@package` e `@subpackage`) foram removidas dos blocos de documentos em toda a base de código. [GitHub-30061](https://github.com/magento/magento2/issues/30061)

<!-- ENGCOM-8117 -->

* Parâmetros não utilizados na construção da classe `AdvancedPricing` foram removidos. [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### Produtos configuráveis

<!-- MC-35016-->

* A filtragem de produtos configuráveis indisponíveis por preço agora exibe os resultados dentro da faixa de preço correta.

<!-- MC-38930-->

* Um produto virtual não altera mais o tipo quando seu status é alterado de ativado para desativado (ou vice-versa). Anteriormente, o aplicativo alterava o tipo de um produto de virtual para simples quando seu status era alterado.

<!-- MC-38197-->

* O método `getValue()` não aciona mais um erro fatal ao atualizar carrinhos.

<!-- MC-34444-->

* Os produtos configuráveis disponíveis em vários sites não mostram mais produtos secundários simples que não estão atribuídos ao site específico. [GitHub-28291](https://github.com/magento/magento2/issues/28291)

<!-- ENGCOM-8202 -->

* As páginas de produtos da loja agora exibem preços de nível sem impostos, conforme esperado. [GitHub-12225](https://github.com/magento/magento2/issues/12225)

<!-- ENGCOM-8134 8174-->

* Os preços de MSRP para produtos configuráveis agora são convertidos corretamente para a moeda escolhida. Anteriormente, o aplicativo exibia os preços na moeda errada e gerava este erro: `Call to a member function setAppliedTaxes() on null`. [GitHub-26526](https://github.com/magento/magento2/issues/26526), [GitHub-29603](https://github.com/magento/magento2/issues/29603)

<!-- ENGCOM-8234 -->

* Os comerciantes agora podem salvar um rótulo de opção de atributo de amostra de texto específico do armazenamento com um valor de 0 (zero). Anteriormente, um valor de 0 era substituído pelo valor da opção Admin label. [GitHub-30073](https://github.com/magento/magento2/issues/30073)

### cron

<!-- MC-37712-->

* A lista de Mensagens do Sistema agora reflete com precisão as atualizações do produto após a execução de `cron` e o aplicativo ter atualizado os produtos conforme agendado.

<!-- ENGCOM-8164 -->

* Um índice baseado em `schedule_id` e `status` foi adicionado à tabela `cron_schedule`. [GitHub-29601](https://github.com/magento/magento2/issues/29601)

### Atributos personalizados do cliente

<!-- MC-23545-->

* O aplicativo agora exibe atributos do cliente do tipo `file` na página Informações da conta após a criação. Anteriormente, ao tentar salvar um novo atributo desse tipo, o aplicativo exibia os seguintes erros: `The "newAttribute" attribute value is empty. Set the attribute and try again` e `Validation is failed`.

<!-- MC-23544-->

* O aplicativo agora exibe corretamente os valores de atributos personalizados de várias linhas do cliente. Anteriormente, nem todos os dados eram exibidos.

<!-- MC-36978-->

* O aplicativo agora alerta os compradores quando eles inserem uma data de nascimento inválida ao criar uma conta. Anteriormente, o validador desconsiderava as configurações de local e os compradores eram redirecionados para a página Criar nova conta do cliente com um erro de data inválida.

<!-- MC-38846-->

* Os atributos personalizados do endereço agora são incluídos, conforme esperado, na etapa Pagamento do fluxo de trabalho de finalização.

<!-- MC-38114-->

* Os atributos de multisseleção de endereço personalizado agora são exibidos corretamente durante o check-out do convidado e na página de detalhes do pedido de Administrador e Minha conta.

<!-- MC-37101-->

* Agora você pode excluir um zero à esquerda em um atributo de cliente personalizado quando `Input Type` está definido como `Text` e `Input Validation` está definido como `Numeric Only`.

<!-- MC-36721-->

* O aplicativo agora exporta com êxito dados do cliente que incluem um valor de atributo de gênero personalizado.

### Cliente

<!-- MC-35771-->

* O widget de calendário para o campo de data de nascimento da página da conta do cliente da loja agora usa o local da loja designado.

<!-- MC-38498-->

* O aplicativo não salva mais entradas duplicadas de um endereço de cliente durante o check-out de um novo pedido para um cliente existente do administrador.

<!-- MC-37393-->

* A exclusão de todos os endereços de vários clientes do Admin agora exclui todos os endereços da lista de endereços do cliente e remove os endereços padrão de faturamento e envio. Anteriormente, o aplicativo excluía o endereço da lista de endereços do cliente, mas não removia os endereços padrão de cobrança e envio.

<!-- MC-37377-->

* A guia Admin customer address agora exibe corretamente a contagem de endereços depois que um administrador executa uma exclusão em massa de endereços. Anteriormente, o aplicativo incluía endereços excluídos em sua contagem.

<!-- MC-36718-->

* O formato DateTime para o campo **Data de Nascimento** na página de registro do cliente foi corrigido. Anteriormente, o zero à esquerda que precedia um dia de um dígito estava ausente.

<!-- MC-36024-->

* A validação do formato de data para o campo **Data de Nascimento** agora funciona antes que o comprador clique no botão **Criar uma conta**. Anteriormente, um comprador podia inserir um valor em um formato inválido e, ao clicar no botão **Criar uma conta**, ele era redirecionado para a página Criar nova conta de cliente com um erro de data inválida.

<!-- MC-33867-->

* O aplicativo não lança mais um erro fatal quando um administrador tenta salvar uma nova conta de cliente que contém dados inválidos para um atributo.

<!-- MC-36258-->

* O aplicativo não lança mais um erro 400 quando um cliente tenta acessar o carrinho de compras em uma implantação em que o Magento Shipping foi instalado anteriormente e o tema Luma padrão está implantado no momento. Anteriormente, o aplicativo não filtrava nomes de seção criados por módulos instalados/habilitados anteriormente que não eram compatíveis com o Administrador antes de enviar solicitações ao servidor, o que gerava erros.

<!-- MC-35812-->

* O aplicativo agora exibe uma mensagem conforme esperado quando um comprador cria uma conta de convidado quando a configuração **Solicitar Confirmação de Emails** está habilitada e `Magento\Customer\Controller\Account\CreatePost` foi substituída. Anteriormente, o aplicativo não permitia esse tipo de personalização do processo de registro do usuário e, nessas condições, o status de confirmação de email de um usuário era considerado concluído, o novo usuário era conectado automaticamente e nenhuma mensagem de erro era exibida.

<!-- ENGCOM-8039 -->

* O aplicativo agora atribui um comprador ao grupo correto de clientes quando o comprador faz um pedido com um grupo de clientes não padrão em uma loja onde a **Habilitar Atribuição automática ao Grupo de Clientes** está habilitada. [GitHub-26976](https://github.com/magento/magento2/issues/26976)

<!-- MC-39783-->

* A grade de clientes Admin agora está disponível conforme esperado quando o site não padrão é excluído em uma implantação multissite quando os índices são definidos como **Atualizar por Agendamento**. Anteriormente, o aplicativo não exibia a grade e exibia este erro: `[2020-12-09 11:31:54] report.CRITICAL: The website with id 2 that was requested wasn't found. Verify the website and try again. \{"exception":"[object] (Magento\\Framework\\Exception\\NoSuchEntityException(code: 0): The website with id 2 that was requested wasn't found. Verify the website and try again. at /var/www/html/magento24ee/vendor/magento/module-store/Model/WebsiteRepository.php:110)"}`

### dotdigital

* O tratamento de erros foi aprimorado ao recuperar listas de programas da Dotdigital Engagement Cloud.

* O valor sincronizado na coluna de nome de armazenamento durante a sincronização do convidado agora é o nome de exibição de armazenamento conforme esperado. Anteriormente, o nome do site era incluído nesta coluna.

* Adição de uma verificação de matriz antes de executar looping sobre automações de status de pedido depois que um pedido é salvo.

* Correção de problemas com atualizações do Composer que eram o resultado da dependência do módulo dotdigital no `magento/module-authorization`.

### Baixável

<!-- ENGCOM-7679 -->

* O aplicativo não lista mais um produto baixável na guia Meus produtos de download depois que o pedido ao qual ele pertence foi parcialmente reembolsado. [GitHub-28388](https://github.com/magento/magento2/issues/28388)

### EAV

<!-- MC-35934-->

* Os atributos personalizados que usam `\Magento\Eav\Model\Entity\Attribute\Backend\ArrayBackend` agora usam valores padrão se nenhum valor for fornecido na carga quando um produto é criado por chamada de API.

### Email

<!-- ENGCOM-7961 -->

* `\Magento\Config\Model\Config\Source\Email\Template::toOptionArray` não lança mais um erro quando `setPath()` não é chamado antes de `toOptionArray()`. [GitHub-29315](https://github.com/magento/magento2/issues/29315)

<!-- MC-36777-->

* O aplicativo agora converte corretamente o texto sem formatação para o HTML quando você clica em **Retornar Versão Html** ao carregar um modelo de email.

<!-- MC-34803-->

* O email enviado para clientes que contêm faturas parciais agora inclui subtotais precisos de itens. Anteriormente, o subtotal deste email era o total da quantidade solicitada, não o valor total da quantidade faturada.

<!-- MC-38337-->

* O aplicativo agora envia lembretes de email para todos os clientes relevantes com endereços de email válidos. Anteriormente, o aplicativo parava de enviar emails de lembrete para os clientes após encontrar um endereço inválido.

<!-- ENGCOM-7517 -->

* O envio de emails de vendas no modo assíncrono agora funciona como esperado depois que um produto é removido de um catálogo. Anteriormente, o envio assíncrono de email era bloqueado, e o aplicativo exibia este erro: `main.ERROR: Cron Job sales_send_order_invoice_emails has an error: Call to a member function getData() on null. Statistics: {"sum":0,"count":1,"realmem":0,"emalloc":0,"realmem_start":73400320,"emalloc_start":37177640} [] []main.CRITICAL: Error when running a cron job {"exception":"[object] (RuntimeException(code: 0): Error when running a cron job at /var/www/html/vendor/magento/module-cron/Observer/ProcessCronQueueObserver.php:327, Error(code: 0): Call to a member function getData() on null at /var/www/html/vendor/magento/module-catalog/Helper/Image.php:502)"} []`. [GitHub-26878](https://github.com/magento/magento2/issues/26878)

<!-- ENGCOM-8381 -->

* O aplicativo não copia mais um cliente no email de confirmação do pedido quando `sales_email/order_comment/enabled` está desabilitado e `sales_email/order_comment/copy_method` está definido como `bcc`. [GitHub-29915](https://github.com/magento/magento2/issues/29915)

### Estruturas

<!-- MC-24195-->

* Agora os grupos de filtros personalizados são aplicados corretamente ao pesquisar por clientes. Anteriormente, a função `afterSearch` não possuía filtros OR conforme esperado. [GitHub-24576](https://github.com/magento/magento2/issues/24576)

<!-- MC-36942-->

* As imagens na página inicial de uma loja agora são renderizadas com sucesso. Anteriormente, o HTML de origem da página era corrompido porque as três barras consecutivas no código base64 da imagem eram interpretadas incorretamente como um comentário.

<!-- MC-37369-->

* O DatePicker agora funciona corretamente ao filtrar pedidos na lista Pedidos de administrador nas lojas usando a localidade árabe (`ar_SA - Saudi Arabia`).

<!-- MC-38344-->

* DatePicker agora exibe a data correta depois que um comerciante salva uma regra de preço de carrinho em uma implantação. [GitHub-30382](https://github.com/magento/magento2/issues/30382)

<!-- MC-31085-->

* O aplicativo agora representa corretamente o agrupamento de milhares de árabes e símbolos de separador decimal árabe. Anteriormente, os símbolos árabes eram aparados. [GitHub-26676](https://github.com/magento/magento2/issues/26676)

<!-- MC-30631-->

* O aplicativo agora exclui sessões de banco de dados expiradas da tabela de banco de dados `session`, conforme esperado.

### Correções gerais

<!-- MC-38105-->

* Agora você pode configurar um manipulador de sessão nativo que difere do manipulador definido em `php.ini`. Anteriormente, `SessionManager` não definia o memcache como `save_handler`, mas usava o `session_handler` do arquivo. o aplicativo emitiu este erro: `main.CRITICAL: Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 {"exception":"[object] (Exception(code: 0): Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in ../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 at ../vendor/magento/framework/App/ErrorHandler.php:61)"}`. [GitHub-24717](https://github.com/magento/magento2/issues/24717)

<!-- ENGCOM-8052 -->

* As seguintes melhorias foram realizadas nos módulos `LoginAsCustomer`:

   * O plug-in `around` foi substituído por `after`

   * Código redundante removido

   * Substituiu `(bool)->getValue()` por `isSetFlag`. [GitHub-29689](https://github.com/magento/magento2/issues/29689)

<!-- ENGCOM-8093 -->

* Recarregar todas as seções de dados do cliente com o curinga (*) não faz mais com que as solicitações a `customer/section/load` exibam um erro 400. [GitHub-28154](https://github.com/magento/magento2/issues/28154)

<!-- ENGCOM-7994 -->

* O aplicativo agora passa exceções que ocorrem quando um layout é renderizado no modo de produção para `var/report`. [GitHub-29606](https://github.com/magento/magento2/issues/29606)

<!-- MC-35058-->

* Os comerciantes agora podem cancelar a atribuição de produtos de categorias conforme esperado. Anteriormente, o aplicativo emitia um erro semelhante a este erro: `Could not save product "4" with position 0 to category 3`.

<!-- ENGCOM-7527 -->

* O aplicativo agora lança uma exceção quando um cliente que não existe solicita uma redefinição de senha. [GitHub-26288](https://github.com/magento/magento2/issues/26288)

<!-- MC-33687 ENGCOM-8497-->

* A aplicação agora exibe uma mensagem de erro informativa quando um administrador tenta salvar uma conta de cliente que contém um valor inválido para um atributo do cliente enquanto carrega um arquivo com esse valor de atributo. Anteriormente, o aplicativo exibia um erro fatal. [GitHub-30295](https://github.com/magento/magento2/issues/30295)

<!-- ENGCOM-8400 -->

* O aplicativo agora aplica a configuração **Logotipo para exibição de impressão do HTML** aos PDFs de fatura de vitrine conforme esperado. [GitHub-24730](https://github.com/magento/magento2/issues/24730)

<!-- ENGCOM-8425 -->

* `static::` foi substituído por `self::` em toda a base de código para acessar constantes privadas. [GitHub-30781](https://github.com/magento/magento2/issues/30781)

<!-- ENGCOM-8395 -->

* O aplicativo agora abre a página Novo atributo, conforme esperado, quando um comerciante clica no botão **Criar novo atributo** duas vezes durante a criação do produto. Anteriormente, o aplicativo exibia uma página vazia e exibia um erro. [GitHub-30361](https://github.com/magento/magento2/issues/30361)

<!-- ENGCOM-8426 -->

* O aplicativo não exibe mais a mensagem `The coupon code has been accepted` após a remoção de um cupom. [GitHub-30255](https://github.com/magento/magento2/issues/30255)

<!-- ENGCOM-8396 -->

* Os administradores agora podem atribuir widgets a categorias específicas. [GitHub-30009](https://github.com/magento/magento2/issues/30009)

<!-- ENGCOM-8216 -->

* O seletor de atributo `input[type=datetime]` foi substituído por um seletor de tipo de entrada menos específico. [GitHub-30064](https://github.com/magento/magento2/issues/30064)

<!-- ENGCOM-8282 -->

* O aplicativo agora exibe valores específicos da loja associados a atributos de categoria personalizados, conforme esperado. [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-8287 -->

* O aplicativo agora exibe um prompt perguntando se o grupo de clientes deve ser alterado quando você clicar no botão **Validar número IVA** na página de criação do pedido quando o endereço da loja e o destino da remessa pertencerem a países diferentes da UE. [GitHub-29652](https://github.com/magento/magento2/issues/29652)

<!-- ENGCOM-8031 -->

* A classe `\Magento\Catalog\Model\ImageUploader` foi refatorada para usar o novo método `moveFileFromTmp`. [GitHub-29598](https://github.com/magento/magento2/issues/29598)

<!-- ENGCOM-8178 -->

* O aplicativo agora exibe uma mensagem de erro mais informativa quando um comerciante tenta criar um atributo de produto com códigos `product_type` e `type_id` para ser mais descritivo. [GitHub-28479](https://github.com/magento/magento2/issues/28479)

<!-- ENGCOM-8135 -->

* Lógica de validação corrigida para os campos **Duração do token do cliente (horas)** e **Duração do token do administrador (horas)** na página **Lojas** > **Configurações** > **Serviços** > **OAuth** do administrador. [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-8132 -->

* O aplicativo agora analisa corretamente o texto que contém `}}` no campo de conteúdo do widget. [GitHub-12087](https://github.com/magento/magento2/issues/12087)

<!-- ENGCOM-8098 -->

* Agora é possível remover um filtro da página Categorias de produto. Anteriormente, ao tentar excluir o filtro, o aplicativo não permitia que você o removesse e exibia este erro: `Something went wrong`. [GitHub-8538](https://github.com/magento/magento2/issues/8538)

<!-- ENGCOM-8050 -->

* `Magento\Framework\MessageQueue\ConfigInterface` agora pode ser instanciado quando o módulo opcional `Magento_MessageQueue` está desabilitado. Anteriormente, o aplicativo exibia este erro: `PHP Fatal error:  Uncaught Error: Cannot instantiate interface Magento\Framework\MessageQueue\ConfigInterface in /var/www/magento2/magento2/lib/internal/Magento/Framework/ObjectManager/Factory/AbstractFactory.php:121`. [GitHub-26080](https://github.com/magento/magento2/issues/26080)

<!-- ENGCOM-7312 -->

* A lógica que determina quando o aplicativo pode recuperar o valor do e-mail do armazenamento persistente foi aprimorada. Anteriormente, o aplicativo exibia campos de senha preenchidos na página de check-out quando um usuário não registrado retornava à página de check-out depois de preencher o campo de email pela primeira vez. [GitHub-26903](https://github.com/magento/magento2/issues/26903)

<!-- ENGCOM-7777 -->

* Um atributo `aclResource` ausente foi adicionado ao bloco da barra de ferramentas do cabeçalho Admin `AdminNotification`. Anteriormente, a entrada da barra de ferramentas Notificação do administrador estava visível mesmo quando o usuário administrador não tinha permissões de recurso de função para vê-la. [GitHub-29067](https://github.com/magento/magento2/issues/29067)

<!-- ENGCOM-8022 -->

* As funções `framework/database/select` `where` agora manipulam `type` corretamente. [GitHub-29590](https://github.com/magento/magento2/issues/29590)

<!-- ENGCOM-8260 -->

* O uso ineficiente de `array_merge` em loops foi aprimorado em toda a base de código, o que melhorou o desempenho em vários lugares, incluindo no processo de implantação de conteúdo estático. [GitHub-30183](https://github.com/magento/magento2/issues/30183)

<!-- ENGCOM-8445 -->

* O tempo de vida padrão da sessão de Administrador foi movido do módulo de criptografia para o módulo de segurança. [GitHub-30859](https://github.com/magento/magento2/issues/30859)

<!-- ENGCOM-8425 -->

* O aplicativo agora verifica se há constantes privadas em uma classe e exibe um aviso se houver alguma chamada `static::` para elas. Anteriormente, o aplicativo exibia este erro: `Undefined class constant`.

<!-- ENGCOM-8326 -->

* Adicionado suporte para `root` com link simbólico em páginas de erros e modo de manutenção. Anteriormente, se `root` ou `magento/pub` estivessem vinculados de forma simbólica a um diretório diferente, o processador de erros (`Magento\Framework\Error\Processor`) não geraria uma URL de arquivo de exibição correta. [GitHub-30296](https://github.com/magento/magento2/issues/30296)

<!-- ENGCOM-8087 -->

* Adicionada a matriz `order_data` ausente às classes `EmailSender`. Isso alinha essas classes com a recomendação da Magento de usar variáveis escalares em vez de objetos nos modelos de email. [GitHub-29604](https://github.com/magento/magento2/issues/29604)

### GraphQL

<!-- MC-37615-->

* O resolvedor de URL do GraphQL agora lida com os parâmetros de consulta corretamente. Anteriormente, retornava NULL ao manipular URLs amigáveis para SEO com parâmetros.

<!-- ENGCOM-8422 -->

* O resolvedor de URL do GraphQL agora lida corretamente com a hierarquia de páginas do CMS. Anteriormente, retornava NULL. [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209-->

* As consultas aos dados `categories.breadcrumbs` de um produto não retornam mais dados de navegação estrutural para categorias cuja categoria principal está desabilitada. [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* O caminho para uma imagem de categoria agora é retornado corretamente quando substituições de URL são desativadas.

<!-- MC-36648-->

* O aplicativo agora retorna uma mensagem mais informativa quando ocorre um erro durante uma operação de redefinição de senha do GraphQL. [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078-->

* As posições de produtos agora são atualizadas conforme esperado nos resultados de consulta do GraphQL quando os resultados da consulta são armazenados em cache.

<!-- MC-35355-->

* A consulta `products` agora retorna os resultados esperados quando `category_id`  o filtro está especificado com a palavra-chave `in`. [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8219 -->

* Regras adicionadas ao `editorconfig` para oferecer suporte ao recuo de dois espaços de arquivos JSON e YAML. [GitHub-30066](https://github.com/magento/magento2/issues/30066), [GitHub-30063](https://github.com/magento/magento2/issues/30063)

<!-- ENGCOM-8079 -->

* A classe `FlushCacheByTags` foi atualizada para usar plug-ins subsequentes, em vez de usar plug-ins adjacentes. [GitHub-29558](https://github.com/magento/magento2/issues/29558)

<!-- ENGCOM-8370 -->

* O código no arquivo `checkout_index_index.xml` foi aprimorado pela remoção de `sortOrder` dos componentes `messages`, `authentication`, `progressBar`, `estimation` e `sidebar checkout`. [GitHub-30550](https://github.com/magento/magento2/issues/30550)

<!-- ENGCOM-8379 -->

* O conteúdo em `calc` agora tem escape, o que resulta na correção de `calc` valores no arquivo de saída CSS. Anteriormente, o aplicativo retornava um valor `calc` incorreto. [GitHub-30542](https://github.com/magento/magento2/issues/30542)

<!-- ENGCOM-8030 -->

* O gerador de regravação de URL agora define os objetos de categoria `url_key`, `url_path` e `store_id` como valores de repositório padrão ao salvar regravações de URL de categoria para o escopo global. Anteriormente, ele salvou `url_key`, `url_path` e `store_id` com os valores da última ID de armazenamento processada. [GitHub-29585](https://github.com/magento/magento2/issues/29585)### Produtos agrupados

<!-- MC-35361-->

* A consulta products agora retorna todos os dados esperados para produtos agrupados. Anteriormente, `product_links` era uma matriz vazia.

<!-- MC-37718-->

* Um produto agrupado agora é listado como indisponível na página de edição do produto quando todos os produtos simples secundários estão indisponíveis.

<!-- MC-37249-->

* O status de um produto agrupado agora é atualizado corretamente na página de edição do produto quando o status de seus produtos simples secundários é alterado para esgotado. Anteriormente, o item de estoque do estoque do pai do produto agrupado não era atualizado depois que seu filho alterava o status do estoque.

<!-- ENGCOM-8250 -->

* `\Magento\Widget\Controller\Adminhtml\Widget\Instance\Validate` agora reconhece um valor de resultado de frase como uma mensagem de erro e o envia para o usuário durante a validação do widget. [GitHub-27397](https://github.com/magento/magento2/issues/27397)

<!-- ENGCOM-8311 -->

* A lista codificada permanentemente de atributos de categoria em `Magento\Catalog\Model\Category\DataProvider::getFieldsMap()` foi substituída por uma lista de atributos gerados do cache. [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-7759 -->

* O hash redundante de `req.http.host/client.ip` foi removido e o hash é manipulado pelo VCL integrado do Verniz. [GitHub-29988](https://github.com/magento/magento2/issues/29988)

<!-- ENGCOM-8302 -->

* Um retorno de chamada de falha foi adicionado ao carregador de arquivos `Magento_Ui`. [GitHub-29557](https://github.com/magento/magento2/issues/29557)

<!-- ENGCOM-8405 -->

* Uma inconsistência de `acl.xml` que ocorreu quando `Magento_LoginAsCustomerAssistance` foi habilitado, mas `Magento_LoginAsCustomerAdminUi` ou `Magento_LoginAsCustomerLog` foram desabilitados foi corrigida. Anteriormente, quando um administrador com essas credenciais tentou fazer logon no Administrador, o aplicativo exibia uma página em branco e exibia este erro quando: `Exception #0 (LogicException): Could not create an acl object: Invalid Document Element 'resource': The attribute 'title' is required but missing. Line: 13`. [GitHub-30680](https://github.com/magento/magento2/issues/30680)

<!-- ENGCOM-8157 -->

* O aplicativo não lança mais um erro `Undefined class constant` quando um `Interceptor` é gerado durante a criação do plug-in. [GitHub-28981](https://github.com/magento/magento2/issues/28981), [GitHub-29879](https://github.com/magento/magento2/issues/29879)

<!-- ENGCOM-8108 -->

* O aplicativo agora lida corretamente com mensagens e registros para operações assíncronas em massa. Anteriormente, embora os produtos tenham sido atualizados, as tabelas `magento_operation` e `queue_message_status` não foram atualizadas corretamente e as mensagens do sistema estavam incorretas. [GitHub-29718](https://github.com/magento/magento2/issues/29718)

<!-- ENGCOM-8388 -->

* Um comprador agora é redirecionado para a página Definir uma Nova Senha, conforme esperado, quando clica em **Definir uma Nova Senha** no email Redefinir Senha quando **Exigir Confirmação de Emails** está habilitado para o armazenamento. Anteriormente, o comprador era redirecionado de volta ao botão **Esqueceu sua senha** na página de logon. [GitHub-27954](https://github.com/magento/magento2/issues/27954)

<!-- ENGCOM-8337 -->

* Erro de conversão de matriz em cadeia de caracteres corrigido ao salvar a configuração do sistema de linhas com valores padrão. [GitHub-30314](https://github.com/magento/magento2/issues/30314)

<!-- ENGCOM-8440 -->

* Agora você pode definir argumentos para filas de mensagens. [GitHub-30216](https://github.com/magento/magento2/issues/30216)

<!-- ENGCOM-8384 -->

* O coletor de arquivos base agora respeita `AppState->emulateAreaCode()`. [GitHub-39656](https://github.com/magento/magento2/issues/29656)

<!-- ENGCOM-8441 -->

* A nova classe `BlockByIdentifier` oferece suporte à recuperação de um bloco de layout com base no identificador de bloco CMS. Como resultado, quando um bloco CMS é removido do cache, o aplicativo também limpa o cache do bloco de layout. [GitHub-28309](https://github.com/magento/magento2/issues/28309)

<!-- ENGCOM-8385 -->

* Correção de problemas com a conversão de argumento numérico em filas. Anteriormente, ao declarar uma fila com argumentos numéricos `type` em `queue_topology.xml`, o valor do argumento era convertido em cadeia de caracteres. [GitHub-29615](https://github.com/magento/magento2/issues/29615)

### GraphQL

<!-- MC-37615-->

* A consulta `urlResolver` agora trata os parâmetros de consulta corretamente.

<!-- ENGCOM-8422 -->

* A consulta `urlResolver` não retorna mais NULL quando um nó e uma página personalizados do CMS são especificados como entrada. [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209 ENGCOM-8386-->

* A consulta `category` não retorna mais categorias filhas de uma categoria pai que foi desabilitada. [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* A consulta `category` agora retorna o caminho correto de uma imagem de categoria quando substituições de URL são desabilitadas.

<!-- MC-36648 8321-->

* A mutação `resetPassword` agora retorna uma mensagem mais informativa quando ocorre um erro. [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078 ENGCOM-8504-->

* Os resultados em cache da consulta `products` são invalidados conforme esperado quando as posições do produto são alteradas. [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- MC-35355 ENGCOM-8404-->

* A consulta `products` agora retorna os resultados esperados quando o filtro `category_id` é especificado com a palavra-chave `in`. [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8373 -->

* As consultas `categories` e `categoryList` agora consideram a disponibilidade da categoria com base na configuração de permissões de categoria e na ID da categoria pai. [GitHub-29880](https://github.com/magento/magento2/issues/29880), [GitHub-30624](https://github.com/magento/magento2/issues/30624)

<!-- MC-37603-->

* A mutação `updateProductsInWishList` agora valida corretamente os itens da lista de desejos. [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- ENGCOM-8430 PWA-1107-->

* Vários atributos obsoletos no `ProductInterface` e `CategoryInterface` para impedir seu uso na loja. [GitHub-30625](https://github.com/magento/magento2/issues/30625)

* Os preços agora ficam ocultos nos resultados de consultas de produtos quando as permissões de categoria são definidas para ocultá-los. [GitHub-29926](https://github.com/magento/magento2/issues/29926)

<!-- MC-36898 PWA-1299-->

* Agora você pode usar a mutação `addProductsToWishList` para adicionar um produto de pacote com uma quantidade definida pelo usuário a uma lista de desejos.

<!-- MC-36946 -->

* O tempo de resposta do GraphQL para operações de adição ao carrinho melhorou.

<!-- ENGCOM-8099 -->

* A consulta `products` agora retorna valores de preço de camada conforme esperado. [GitHub-29168](https://github.com/magento/magento2/issues/29168)

<!-- ENGCOM-7528 -->

* Removido um `getMappedNums` redundante de um loop em `lib/internal/Magento/Framework/GraphQl/Query/EnumLookup.php`. [GitHub-30031](https://github.com/magento/magento2/issues/30031)

<!-- ENGCOM-8172 -->

* A consulta `products` não retorna mais um erro quando o produto consultado tem um produto relacionado desabilitado. [GitHub-28892](https://github.com/magento/magento2/issues/28892)

<!-- MC-37395 -->

* A consulta `cart` agora retorna preços que foram convertidos para a moeda correta (a moeda de exibição padrão). Anteriormente, a consulta retornava o valor do preço do item na moeda base e o código da moeda era retornado como a moeda de exibição padrão.

<!-- MC-37388-->

* O GraphQL agora respeita as permissões do catálogo. O aplicativo restringe quais itens são retornados para uma consulta `products` com base no grupo de clientes do comprador.

<!-- MC-39690-->

* Adição do atributo `customizable_option` a vários tipos de dados que implementam o `CartItemInterface`.

<!-- MC-39744-->

* Adicionados atributos para a consulta `storeConfig` para retornar informações de armazenamento, grupo de armazenamento e site.

<!-- MC-37414-->

* O atributo `SelectedCustomizableOption.type` foi restabelecido. Além disso, o atributo `customizable_options` em várias implementações de `CartItemInterface` agora é não nulo.

<!-- MC-23860-->

* A funcionalidade de pesquisa da consulta `products` não retorna mais itens nos quais as permissões de categoria foram habilitadas.

<!-- MC-37726-->

* A consulta `products` retorna a moeda correta para exibições de loja com várias moedas.

<!-- MC-37727-->

* Os rótulos para `products` filtros de consulta agora retornam valores traduzidos, quando aplicável para exibições de armazenamento não padrão.

<!-- MC-37728-->

* Valores monetários de armazenamento fixos em cartões-presente no carrinho.

<!-- MC-38443-->

* Adição do tipo de dados `ConfigurableProductOptionsSelection`, que contém metadados correspondentes às opções configuráveis selecionáveis para um produto. Use este objeto em uma consulta `products` para minimizar o número de itens da galeria de mídia exibidos à medida que o comprador seleciona opções de produto configuráveis.

### Imagens

<!-- MC-36942-->

* As imagens na página inicial de uma loja agora são renderizadas com sucesso. Anteriormente, o HTML de origem da página era corrompido porque as três barras consecutivas no código base64 da imagem eram interpretadas incorretamente como um comentário.

<!-- ENGCOM-8116 -->

* A dependência na extensão `fileinfo` foi removida do módulo CMS. Anteriormente, o aplicativo exibia um erro ao tentar carregar uma imagem usando o carregador de imagens, que é iniciado quando você clica no botão **Inserir Imagem** ao adicionar conteúdo. [GitHub-24332](https://github.com/magento/magento2/issues/24332), [GitHub-16531](https://github.com/magento/magento2/issues/16531), [GitHub-29852](https://github.com/magento/magento2/issues/29852)

<!-- ENGCOM-8020 -->

* Adicionado suporte para leitura de `exif_image.png` ou `exif-image.jpeg` metadados. [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8296 -->

* As cores das imagens CMYK agora são renderizadas corretamente. Quando o adaptador Imagick detecta agora que uma imagem aberta tem um espaço de cores CMYK, esse espaço é convertido em SRGB. Antes, essas imagens eram renderizadas com cores invertidas. [GitHub-22375](https://github.com/magento/magento2/issues/22375)

<!-- ENGCOM-8251 -->

* Os valores booleanos não estão mais definidos para `image_with_border.phtml`. As configurações `max-width` e `height` redundantes foram removidas de `.product-image-photo`. (Esses valores já estão definidos globalmente na imagem por meio dos estilos de redefinição.) [GitHub-30186](https://github.com/magento/magento2/issues/30186)

### Importar/exportar

<!-- MC-35081-->

* O endereço do cliente `region_id` não recebe mais um valor `NULL` quando você importa endereços de clientes usando um arquivo CSV (`entity type = "customer address"` e `import behavior = "add/update"`) do qual determinados valores de campo foram excluídos.

<!-- MC-35295-->

* Agora é possível ocultar imagens do produto na loja durante a importação.

<!-- MC-35836-->

* Quando um produto importado tem o `qty` definido como 0, mas o `is_in_stock set` como 1 no arquivo CSV, o produto não é listado na página de categoria e a página de detalhes do produto o identifica como indisponível. Anteriormente, os produtos com esses valores estavam visíveis na loja após a importação.

<!-- MC-38433-->

* A importação de CSV não ignora mais os valores `dropdown` e `textarea` para atributos adicionais. Anteriormente, esses valores de atributo não eram atualizados durante a importação.

<!-- MC-37933-->

* O arquivo CSV de exportação do produto agora aparece na lista de administração de arquivos CSV de exportação, conforme esperado. Anteriormente, o aplicativo emitia um erro quando você executava este comando: `bin/magento queue:consumers:start exportProcessor --single-thread --max-messages=10000`.

<!-- MC-37672-->

* O aplicativo não emite mais um erro ao importar dados CSV que incluam caracteres do alfabeto bengali (bengali).

<!-- MC-36410-->

* O aplicativo agora exibe uma mensagem informativa de erro quando um administrador clica em **Verificar Dados** durante a importação de um arquivo que foi alterado desde a exportação ao trabalhar no Chrome. Anteriormente, o aplicativo exibia um erro de console, mas não informava ao usuário como proceder.

<!-- ENGCOM-8252 -->

* O aplicativo não duplica mais imagens de produtos quando você importa os mesmos dados CSV de produtos mais de uma vez. [GitHub-21885](https://github.com/magento/magento2/issues/21885)

<!-- ENGCOM-8262 -->

* O limite de 90 caracteres para nomes de arquivo de imagem em `vendor/magento/framework/File/Uploader.php` foi removido.  Anteriormente, o nome do diretório e do arquivo não podiam exceder 255 caracteres. O aplicativo importou produtos com imagens cujo nome de arquivo excedeu esse limite, mas não importou o arquivo de imagem. [GitHub-29377](https://github.com/magento/magento2/issues/29377)

<!-- ENGCOM-8153 -->

* Os códigos de cupom agora podem ser exportados com êxito para CSV ou XML. Anteriormente, o aplicativo exibia um erro 404 ao clicar em **Exportar CSV** ou **Exportar XML** ao tentar exportar cupons. [GitHub-29277](https://github.com/magento/magento2/issues/29277)

<!-- ENGCOM-8252 -->

* As imagens do produto duplicadas agora são removidas após a importação de um arquivo CSV que contém imagens. [GitHub-14398](https://github.com/magento/magento2/issues/14398), [GitHub-21885](https://github.com/magento/magento2/issues/21885)

### Índice

<!-- MC-38003-->

* Melhoramos o desempenho do indexador parcial. O aplicativo agora limpa as IDs do cache que foram alteradas para cada iteração em lote de 1000 ID. O contexto de cache não acumula mais IDs. Anteriormente, o contexto de cache acumulava IDs de cache para cada iteração em lote de 1000 ID e limpava o mesmo conjunto de IDs em cada iteração.

<!-- ENGCOM-7929 -->

* As inconsistências entre o sistema de reindexação parcial e o sistema de reindexação completo foram corrigidas. Ambos os sistemas de indexação agora usam o mesmo código, que funciona corretamente. Anteriormente, ambos os sistemas de indexação usavam uma lógica diferente em relação aos indexadores compartilhados, o que potencialmente fazia com que os indexadores fossem invalidados após cada execução do sistema de reindexação parcial. [GitHub-29478](https://github.com/magento/magento2/issues/29478), [GitHub-29297](https://github.com/magento/magento2/issues/29297)

<!-- MC-38168-->

* Resolvemos problemas com o indexador manual que resultavam em páginas de categoria vazias ou em uma contagem reduzida de produtos nas páginas de categoria. Problemas com páginas de categoria incompletas ou contagem de produtos ocorreram quando:

   * os indexadores parciais `catalogsearch_fulltext` e `catalog_product_price` foram executados em um catálogo grande até que esses indexadores concluíssem a execução.

   * o indexador parcial foi executado em `catalog_category_product` ou `catalog_product_category` índices e, ao mesmo tempo, uma reindexação completa foi executada em um desses índices. Esses dois processos de indexação podiam entrar em conflito, o que resultava na ausência de produtos nas páginas de categoria.

   * `bin/magento indexer:reindex inventory` foi executado em um catálogo grande. Faltavam produtos nas páginas de categoria até que o indexador parcial `catalogsearch_fulltext` concluísse a execução.

<!-- MC-39700-->

* Um indexador foi adicionado à tabela MySQL `Magento_Bulk`, o que melhorou o desempenho das operações em massa.

<!-- MC-38806-->

* Os comentários nas tabelas do banco de dados agora refletem com precisão o status da tabela após a reindexação (`bin/magento indexer:reindex`). Anteriormente, os comentários da tabela após a reindexação continham os mesmos valores que os comentários contidos após uma nova instalação.

<!-- ENGCOM-7542 -->

* A instrução `SELECT entity_id IN` foi aprimorada nas implantações que implementam o MariaDB v.10.3.18, o que melhorou o desempenho da indexação de categorias de catálogos. [GitHub-25199](https://github.com/magento/magento2/issues/25199)

<!-- ENGCOM-8237 -->

* A Magento Open Source melhorou o desempenho do cache ao eliminar a liberação de tags várias vezes por instância do indexador. [GitHub-29890](https://github.com/magento/magento2/issues/29890)

### Infraestrutura

<!-- MC-34353-->

* Agora você pode usar `app/etc/env.php` para alterar o agente de mensagens de MYSQL para AMQP.

<!-- MC-38242-->

* Problemas com o cálculo dos remanescentes de valores decimais para quantidades de produtos foram corrigidos na biblioteca JavaScript relevante. O aplicativo calculou anteriormente frações decimais de mais de dois dígitos incorretamente e, posteriormente, exibiu uma mensagem incorreta.

<!-- MC-38993 ENGCOM-8473-->

* O método `\Magento\Authorization\Model\Rules::update` foi substituído.  [GitHub-29128](https://github.com/magento/magento2/issues/29128)

<!-- ENGCOM-8000 -->

* O aplicativo não lança mais um erro fatal ao converter um objeto de data de UTC. Anteriormente, sob determinadas condições, o método `convertConfigTimeToUtc` gerava uma exceção. [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7987 -->

* `DataObject` foi substituído pelo modelo de produto em `\Magento\MediaGalleryCatalogUi\Ui\Component\Listing\Columns\Thumbnail::prepareDataSource`.[GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- ENGCOM-7914 -->

* O resolvedor `RequireJS` não falha mais ao detectar recursos bloqueados. Anteriormente, o resolvedor não detectava corretamente se todos os recursos em uma página eram carregados ou manipulados adequadamente e a página continuava carregando. [GitHub-28116](https://github.com/magento/magento2/issues/28116)

<!-- ENGCOM-8229 -->

* A validação do código do Repositório de Atributos agora respeita `Magento\Eav\Model\Entity\Attribute::ATTRIBUTE_CODE_MAX_LENGTH` em vez de um valor embutido em código. [GitHub-29017](https://github.com/magento/magento2/issues/29017)

<!-- MC-35699-->

* A minificação do HTML não remove mais as barras triplas (//) das strings do HTML em arquivos PHTML. Anteriormente, as barras triplas eram interpretadas como comentários durante a minificação, e o restante da linha era completamente removido no arquivo PHTML gerado após a implantação.

<!-- MC-38201-->

* Os comerciantes agora podem configurar assinaturas de indexador no nível da coluna da tabela, em vez do nível da tabela. Um novo argumento foi adicionado a `\Magento\Framework\Mview\View\Subscription` para permitir que as colunas sejam ignoradas para uma exibição ou combinação de tabelas específica. [GitHub-30243](https://github.com/magento/magento2/issues/30243)

<!-- MC-30171-->

* Clicar no botão **Adicionar ao carrinho** antes que a página do produto JavaScript seja totalmente inicializada não resulta mais em valores `form_key` duplicados. Anteriormente, um produto podia ser adicionado ao carrinho com um valor `form_key` em cache que acionava uma exceção. Quando **Adicionar ao carrinho** for clicado antes que o JavaScript seja totalmente inicializado, o valor `form_key` enviado nos dados de formulário não corresponderá à sessão dos usuários e o produto não será adicionado ao carrinho. [GitHub-13746](https://github.com/magento/magento2/issues/13746)

<!-- ENGCOM-8107 -->

* O cliente cURL atual agora respeita nomes de cabeçalho que não diferenciam maiúsculas de minúsculas. Anteriormente, a comparação `Set-Cookie` diferenciava maiúsculas de minúsculas, o que poderia causar problemas em alguns servidores HTTP. [GitHub-29524](https://github.com/magento/magento2/issues/29524)

<!-- ENGCOM-8360 -->

* Formato XSD URN atualizado em `api-functional` e arquivos XML de caso de teste. [GitHub-30552](https://github.com/magento/magento2/issues/30552)

<!-- ENGCOM-8295 -->

* Um prefixo de evento e um objeto de evento foram adicionados à coleção de valores de opção de produto de catálogo para melhorar a personalização do carregamento da coleção de `\Magento\Catalog\Model\ResourceModel\Product\Option\Value\Collection`. [GitHub-29621](https://github.com/magento/magento2/issues/29621)

<!-- ENGCOM-8261 -->

* Todas as ocorrências de `array_merge` foram refatoradas para usar o formato recomendado no padrão de codificação. [GitHub-30005](https://github.com/magento/magento2/issues/30005)

<!-- ENGCOM-7718 -->

* Um bloco `head.additional` do tipo `\Magento\Framework\View\Element\Text\ListText` foi adicionado ao layout `adminhtml` `default` (por `magento2/module-base`). [GitHub-29165](https://github.com/magento/magento2/issues/29165)

<!-- ENGCOM-8312 -->

* Adição do método de URL de escape ausente ao widget do módulo de modelo de layout. [GitHub-30036](https://github.com/magento/magento2/issues/30036)

<!-- ENGCOM-8127 -->

* O método `\Magento\Framework\Filesystem\Io\File::read()` agora é compatível com `\Magento\Framework\Filesystem\Io\IoInterface::read()`. [GitHub-27866](https://github.com/magento/magento2/issues/27866)

### Klarna

* Remoção da dependência do módulo PayPal. [GitHub-29421](https://github.com/magento/magento2/issues/29421)

### Logs

<!-- ENGCOM-8443 -->

* O módulo `Magento_Logging` agora registrou corretamente novos valores, bem como os valores que os precederam. Anteriormente, os valores na coluna Valor antes da alteração exibiam valores de N/D, independentemente de essa ser a primeira alteração ou a próxima, ou quando o valor padrão era retornado. [GitHub-26943](https://github.com/magento/magento2/issues/26943)

### Galeria de mídia

<!-- ENGCOM-8014 -->

* A página Admin **Lojas** > **Configuração** > **Avançado** > **Sistema** foi atualizada para exibir o nome de produto correto (Galeria de Mídia). Foram incluídas pequenas reformulações na interface do usuário. [GitHub-1738](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-8019 -->

* Os links na seção Usado em das descrições de imagem da Galeria de mídia agora exibem uma grade que foi filtrada pela imagem selecionada, conforme esperado. Anteriormente, a grade exibida não tinha o título correto e as entradas da lista não eram precisas. [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019 -->

* Agora é possível editar várias imagens com êxito na Galeria de mídia. Anteriormente, não era possível adicionar tags a uma segunda imagem depois de adicionar tags a uma imagem. [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015 -->

* O menu suspenso Tags agora fica vazio, conforme esperado, depois de remover tags de uma imagem na Galeria de mídia.  [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

<!-- ENGCOM-8146 -->

* O processamento em lote de mensagens da fila de sincronização da Galeria de mídia agora é compatível. [GitHub-1724](https://github.com/magento/adobe-stock-integration/issues/1724)

<!-- ENGCOM-8064 -->

* O aplicativo agora exibe uma página 404, como esperado, quando você tenta abrir a Galeria de Mídia quando a **Galeria de Mídia Aprimorada** está desabilitada. [GitHub-1760](https://github.com/magento/adobe-stock-integration/issues/1760)

<!-- ENGCOM-8072 -->

* `MediaGalleryMetadata` agora ignora o leitor de segmento se ocorrer uma exceção. Em vez disso, analisa e exibe metadados de imagem conforme esperado. Anteriormente, os metadados da imagem estavam vazios devido a uma exceção do leitor de segmento `exif_read_data`. [GitHub-1782](https://github.com/magento/adobe-stock-integration/issues/1782)

<!-- ENGCOM-8069 -->

* O comprimento do nome da pasta não impede mais que uma imagem seja carregada na Galeria de mídia. A Galeria de mídia agora define a coluna de caminho como tipo `text`. [GitHub-1778](https://github.com/magento/adobe-stock-integration/issues/1778)

<!-- ENGCOM-8217 -->

* Agora o carregador de imagens exibe o tamanho de imagem correto quando uma representação é inserida da Galeria de mídia. [GitHub-1806](https://github.com/magento/adobe-stock-integration/issues/1806)

<!-- ENGCOM-8467 -->

* A verificação de caminho foi adicionada ao plug-in carregador `Mediagallery`. Anteriormente, a validação falhava, e o aplicativo não importava produtos quando **Habilitar Galeria de Mídia Antiga** estava desabilitado. [GitHub-30649](https://github.com/magento/magento2/issues/30649)

<!-- ENGCOM-8057 -->

* `Magento_Cms::media_gallery` sub-recursos de ACL foram adicionados e aplicados para que a nova Galeria de Mídia ofereça suporte a permissões configuradas para as seguintes operações distintas:

   * Fazer upload de ativos
   * Inserir ativos no conteúdo
   * Excluir ativos
   * Criar pastas
   * Excluir pastas. [GitHub-1487](https://github.com/magento/adobe-stock-integration/issues/1487)

<!-- ENGCOM-8047 -->

* Cadeias de caracteres de texto e nomes de pasta longos da Galeria de mídia não são mais cortados. Anteriormente, o aplicativo exibia imagens e texto cortados e esta mensagem: `We couldn't find any records`. [GitHub-1763](https://github.com/magento/adobe-stock-integration/issues/1763), [GitHub-1758](https://github.com/magento/adobe-stock-integration/issues/1758)

<!-- ENGCOM-8042 -->

* O aplicativo não exibe mais o botão **Adicionar selecionado** quando não há imagens selecionadas ao editar o conteúdo de uma nova página. [GitHub-1769](https://github.com/magento/adobe-stock-integration/issues/1769)

<!-- ENGCOM-8047 -->

* Agora os filtros são aplicados conforme esperado na grade de Categorias **Conteúdo** > **Galeria de Mídia**. [GitHub-1763](https://github.com/magento/adobe-stock-integration/issues/1763)

<!-- ENGCOM-8183 -->

* A configuração de opções de ponto de interrupção de multiplicação da galeria agora funciona conforme esperado. Anteriormente, a configuração das opções de ponto de interrupção não funcionava corretamente porque `mediaCheck` acionou a função de consulta de mídia de saída no carregamento da página. [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### MFTF

<!-- ENGCOM-8359 -->

* Ações repetitivas substituídas por grupos de ações em `CheckStaticBlocksTest`. [GitHub-30561](https://github.com/magento/magento2/issues/30561)

<!-- ENGCOM-8267 -->

* `AdminUpdateCategoryAndMakeInactiveTest` e `VerifyChildCategoriesShouldNotIncludeInMenuTest` foram refatorados para serem compatíveis com as práticas recomendadas MFTF. [GitHub-30058](https://github.com/magento/magento2/issues/30058)

<!-- ENGCOM-8458 -->

* `AdminOpenCMSBlocksGridActionGroup` duplicado removido. [GitHub-30896](https://github.com/magento/magento2/issues/30896)

<!-- ENGCOM-8156 -->

* `AdminOpentCmsBlockActionGroup` substituído por AdminOpenCmsBlockActionGroup. [GitHub-29839](https://github.com/magento/magento2/issues/29839)

<!-- ENGCOM-8226 -->

* Obsoleto `GoToAttributeGridPageActionGroup`. [GitHub-30103](https://github.com/magento/magento2/issues/30103)

<!-- ENGCOM-8061 -->

* Adicionados grupos de ação ao módulo `Analytics`. [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-7334 -->

* Atualização de `CheckCheckoutSuccessPageAsRegisterCustomerTest` e `CheckCheckoutSuccessPageAsGuestTest` para cancelar pedidos criados após a execução de testes. [GitHub-28324](https://github.com/magento/magento2/issues/28324)

<!-- ENGCOM-8214 -->

* Removido `AdminNavigateToPageGridActionGroup` devido à redundância. [GitHub-29838](https://github.com/magento/magento2/issues/29838)

<!-- ENGCOM-8122 -->

* `ActionGroup` implementado para navegar até a página de check-out. [GitHub-29843](https://github.com/magento/magento2/issues/29843)

<!-- ENGCOM-8124 -->

* `AdminOpenCreateNewCMSPageActionGroup` implementado para navegar e criar uma nova página do CMS. [GitHub-29824](https://github.com/magento/magento2/issues/29824)

<!-- ENGCOM-8268 -->

* Correção de problemas ao ignorar testes MFTF para a página do CMS para a Galeria de mídia. [GitHub-30164](https://github.com/magento/magento2/issues/30164)

#### Novos testes

<!-- ENGCOM-7804 -->

* Adição de um teste para ativar o email para um amigo no Administrador. [GitHub-29145](https://github.com/magento/magento2/issues/29145)

<!-- ENGCOM-8316 -->

* Adição de um teste para exclusão de um bloco CMS de uma grade por um administrador. [GitHub-30372](https://github.com/magento/magento2/issues/30372)

<!-- ENGCOM-7933 -->

* Adição de um teste para aplicar uma regra de carrinho de compras a um único item do pacote. [GitHub-28921](https://github.com/magento/magento2/issues/28921)

<!-- ENGCOM-8075 -->

* Adição de testes para verificar se as informações **Usado em** de uma imagem da Galeria de Mídia são exibidas após a exclusão da entidade. [GitHub-1774](https://github.com/magento/adobe-stock-integration/issues/1774)

#### Novos grupos de ação

* `AssertStorefrontCustomerLogoutSuccessPageActionGroup`. [GitHub-29841](https://github.com/magento/magento2/issues/29841) <!-- ENGCOM-8121 -->

* `AdminOpenConfigurationStoresPageActionGroup`. [GitHub-29848](https://github.com/magento/magento2/issues/29848) <!-- ENGCOM-8259 -->

* `ReloadPageActionGroup`. [GitHub-30683](https://github.com/magento/magento2/issues/30683) <!-- ENGCOM-8394 -->

* `StorefrontClickRefundTabCustomerOrderViewActionGroup`. [GitHub-30032](https://github.com/magento/magento2/issues/30032) <!-- ENGCOM-8203 -->

* `AdminOpenAdminThreeDSecurePageActionGroup`. [GitHub-29845](https://github.com/magento/magento2/issues/29845) <!-- ENGCOM-8115 -->

* `AdminCustomerClickFirstRowEditLinkActionGroup`.  [GitHub-29501](https://github.com/magento/magento2/issues/29501) <!-- ENGCOM-8043 -->

* `StorefrontClickAddToCartButtonActionGroup`. [GitHub-29823](https://github.com/magento/magento2/issues/29823) <!-- ENGCOM-8113 -->

* `AdminDeleteTaxRateActionGroup`. [GitHub-29940](https://github.com/magento/magento2/issues/29940) <!-- ENGCOM-8192 -->

* `AdminOpenWebConfigurationPageActionGroup`. [GitHub-29846](https://github.com/magento/magento2/issues/29846) <!-- ENGCOM-8126 -->

* `AdminOpenGeneralConfigurationPageActionGroup`. [GitHub-29847](https://github.com/magento/magento2/issues/29847) <!-- ENGCOM-8114 -->

* `AdminOrderClickSubmitOrderActionGroup`. [GitHub-29649](https://github.com/magento/magento2/issues/29649) <!-- ENGCOM-8023 -->

* `AdminOpenCatalogProductPageActionGroup`. [GitHub-29941](https://github.com/magento/magento2/issues/29941) <!-- ENGCOM-8209 -->

* `AdminClickInvoiceButtonIntoOrderActionGroup`. [GitHub-25399](https://github.com/magento/magento2/issues/25399) <!-- ENGCOM-8210 -->

* `AdminGridBulkActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminGridColumnShowActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminOpenIndexManagementPageActionGroup`. [GitHub-29825](https://github.com/magento/magento2/issues/29825) <!-- ENGCOM-8123 -->

* `AdminOpenCatalogSearchTermIndexPageActionGroup`. [GitHub-29844](https://github.com/magento/magento2/issues/29844) <!-- ENGCOM-8128 -->

* `AdminClickAddProductToggleAndSelectProductTypeActionGroup`. [GitHub-30917](https://github.com/magento/magento2/issues/30917) <!-- ENGCOM-8439 -->

* `StorefrontCheckoutClickSaveAddressButtonActionGroup`. [GitHub-30916](https://github.com/magento/magento2/issues/30916) <!-- ENGCOM-8454 -->

* `AdminOpenCurrencyRatesPageActionGroup`. [GitHub-30783](https://github.com/magento/magento2/issues/30783) <!-- ENGCOM-8432 -->

* `AdminClickGetShippingMethodsAndRatesActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `AdminSelectFixedShippingMethodActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `StorefrontClickProceedToCheckoutActionGroup`. [GitHub-30926](https://github.com/magento/magento2/issues/30926) <!-- ENGCOM-8438 -->

* `StorefrontOpenMyAccountPageActionGroup`. [GitHub-29842](https://github.com/magento/magento2/issues/29842) <!-- ENGCOM-8143 -->

### Informativo

<!-- MC-38789-->

* Os usuários administradores agora podem editar uma conta de cliente conforme esperado quando o cliente é inscrito em um boletim informativo na fila. [GitHub-30645](https://github.com/magento/magento2/issues/30645)

<!-- ENGCOM-8034 -->

* O aplicativo agora reenvia a confirmação de subscrição do boletim informativo se o comprador não confirmar a subscrição. [GitHub-28422](https://github.com/magento/magento2/issues/28422)

<!-- ENGCOM-8429 -->

* Agora é possível editar uma conta de cliente conforme esperado quando o cliente estiver inscrito em um boletim informativo na fila. [GitHub-30645](https://github.com/magento/magento2/issues/30645)

### Métodos de pagamento

<!-- MC-35161-->

* Os métodos de pagamento agora são carregados no Administrador para todos os sites, conforme esperado em uma implantação de várias lojas.

<!-- MC-35152-->

* O aplicativo agora conclui os pagamentos do Payflow Pro com êxito quando o nome do comprador contém letras acentuadas. Anteriormente, o pagamento não era concluído e o aplicativo registrava este erro: `report.CRITICAL: String to be escaped was not valid UTF-8 or could not be converted`.

#### PayPal

<!-- MC-35692-->

* Os comerciantes agora podem fazer um pedido com êxito do Administrador depois de alternar de um método de pagamento que usa um cartão de crédito para um método de pagamento que não é de cartão de crédito. Anteriormente, quando um comerciante clicava no botão **Enviar pedido**, o processo de carregamento começava, mas nunca era concluído, e o pedido não era feito.

<!-- MC-37649-->

* O aplicativo não cria mais pedidos duplicados quando um pedido é feito com o PayPal Express. Anteriormente, quando um comprador tentava pagar um pedido com o PayPal Express, mas o PayPal retornava um erro, o aplicativo ainda criava o pedido. Isso resultou em pedidos duplicados no site do comerciante. [GitHub-13952](https://github.com/magento/magento2/issues/13952)

<!-- MC-38829-->

* Os relatórios do Acordo do PayPal agora estão disponíveis em **Relatórios** > **Vendas** > **Acordo do PayPal**, conforme esperado. Anteriormente, o aplicativo não listava esses relatórios na grade de relatórios de liquidação do PayPal e exibia esta mensagem: `We couldn't find any records`.

<!-- MC-39442-->

* Clicar no botão **PayPal** durante o check-out não dispara mais uma chamada `web-api` redundante. Anteriormente, duas solicitações eram acionadas, o que dobrava o custo do produto.

<!-- ENGCOM-8173 -->

* Os compradores convidados agora podem fazer pedidos do PayPal quando a **Atribuição automática para o grupo de clientes** está habilitada. O pagamento é processado no gateway do PayPal, o pedido é criado no Magento e o comprador visualiza a página de agradecimento do pedido. Anteriormente, o pedido era processado com êxito no gateway do PayPal, mas não era criado no Magento Open Source. Em vez disso, o comprador foi redirecionado para a página de revisão do pedido, onde o aplicativo exibiu este erro: `Failed address validation: %1" error`. [GitHub-25399](https://github.com/magento/magento2/issues/25399)

### Desempenho

<!-- MC-37705-->

* Problemas de desempenho em `module-catalog-import-export/Model/Import/Product/Option.php` foram solucionados. O tempo necessário para exportar ou importar mais de 100.000 registros foi reduzido. Consulte o artigo [Importação/Exportação demora mais do que o esperado com um grande número de opções de produto](https://support.magento.com/hc/en-us/articles/360050695772) da Base de Dados de Conhecimento.

<!-- MC-37799-->

* `Magento_Csp/Model/BlockCache` foi refatorado para reduzir o consumo de memória e a geração de cadeias de caracteres em cache desnecessariamente grandes. Anteriormente, as páginas que incluíam scripts e estilos dinamicamente na lista de permissões eram frequentemente causadas por problemas de desempenho. [GitHub-29964](https://github.com/magento/magento2/issues/29964)

<!-- MC-37816 -->

* Melhoramos o desempenho das exportações programadas de catálogos que incluem mais de 100 mil produtos usando consumidores do.

<!-- MC-38306 -->

* O aplicativo não libera mais o cache de categorias quando você adiciona ou salva um produto desativado em uma categoria. Anteriormente, o aplicativo liberava o cache para categorias relacionadas, apesar do status do produto, que afetava o desempenho do servidor.

<!-- MC-38518 -->

* O tempo de carregamento da página para atualizar a quantidade do produto no carrinho de compras melhorou. Anteriormente, o aplicativo executava várias consultas separadas para cada produto no carrinho de compras, o que aumentava o tempo de carregamento da página.

<!-- MC-39700 -->

* Um indexador foi adicionado à tabela MySQL `Magento_Bulk`, o que melhorou o desempenho das operações em massa.

<!-- MC-38593 -->

* O aplicativo agora armazena em cache as IDs secundárias de produtos configuráveis. Isso melhorou o desempenho do carregamento de página ao reduzir o número de solicitações de banco de dados. [GitHub-30585](https://github.com/magento/magento2/issues/30585)

<!-- MC-37594 -->

* O carregamento do painel de Administrador foi aprimorado. Anteriormente, o aplicativo exibia os nomes das guias como uma lista antes da página concluir o carregamento.

<!-- MC-37417 -->

* O gerenciamento do cache Redis foi aprimorado com a adição de limites de expiração para caches de layout. Anteriormente, os caches Redis atingiam a memória máxima alocada rapidamente em grandes implantações e o aplicativo exibia erros nas operações de gravação.

<!-- ENGCOM-8016 -->

* O desempenho do check-out foi aprimorado pela remoção de uma consulta de banco de dados redundante em `app/code/Magento/Catalog/Model/CategoryLink.php`. [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- ENGCOM-8290 -->

* `Magento\Framework\DB\Adapter\Pdo\Mysql->isTableExists` foi refatorado para melhorar o desempenho. Chamadas redundantes para `SHOW TABLE STATUS` para verificar a existência de uma tabela foram reduzidas. [GitHub-29662](https://github.com/magento/magento2/issues/29662)

<!-- ENGCOM-8258 -->

* `getPageLayoutsConfig` agora está salvo em cache, o que melhorou o desempenho do construtor de configurações. [GitHub-29546](https://github.com/magento/magento2/issues/29546)

### Persistente

<!-- MC-36647 -->

* Os compradores não podem mais fazer um pedido depois que o cookie da sessão expira quando o carrinho persistente está ativado. Em vez disso, o aplicativo exibe a página de logon para que o comprador possa fazer logon. Anteriormente, o aplicativo fez o pedido. O aplicativo não validou corretamente o cliente persistente quando `PHPSESSID` expirou e `customerSession` foi recriado a partir das informações persistentes.

<!-- MC-39127-->

* O aplicativo agora exibe a mensagem Welcome como esperado depois que um comprador faz logon em uma loja onde o carrinho de compras persistente está ativado. Anteriormente, o aplicativo exibia o **Não é você?** mensagem após o logon.

<!-- MC-38269-->

* O aplicativo não exibe mais o **Não é você?** texto quando um cliente seleciona a opção **Lembre-se de mim** ao fazer logon em uma implantação em que o carrinho de compras persistente está habilitado.

<!-- MC-37109-->

* O aplicativo não exibe mais o conteúdo do carrinho de um cliente depois que a sessão de clientes expira. Anteriormente, o aplicativo exibia este erro quando um cliente convidado tentava fazer check-out quando o carrinho de compras persistente era habilitado: `No such entity with cartid = 0`.

### Preços

<!-- MC-34394-->

* As atualizações de preços assíncronas consecutivas não interferem mais entre si, e o status correto é atribuído a cada operação. Anteriormente, se uma atualização de preço assíncrona falhasse, todas as atualizações de preço assíncronas a seguir falhariam até que o consumidor de fila correspondente fosse reiniciado. [GitHub-27865](https://github.com/magento/magento2/issues/27865)

### Relatórios

<!-- MC-36652 38925-->

* **Relatórios** > **Marketing** > **Produtos em Carrinhos** agora exibe somente o registro no escopo permitido do usuário que está gerando o relatório. Anteriormente, todos os dados estavam disponíveis para todos os escopos.

<!-- MC-38074-->

* O aplicativo agora usa a moeda especificada no escopo da função do comerciante que gera o relatório ao exibir a moeda do produto no relatório Produtos no carrinho.

<!-- MC-37934-->

* Os recursos do produto Visualizados recentemente e Comparados recentemente agora exibem estatísticas para diferentes lojas e sites na Administração, conforme esperado na implantação de várias lojas. Anteriormente, esses recursos não levavam em conta todas as lojas ou sites.

<!-- MC-37217-->

* Os relatórios Preços em Ordem agora usam o símbolo de moeda correto.

<!-- ENGCOM-8314 -->

* O aplicativo agora verifica a existência de um token quando um usuário clica no botão **Ir para Relatório Avançado** do painel de Administração.  Se o token existir, o aplicativo exibirá a página Relatórios avançados. Se o token não estiver configurado, o aplicativo exibe uma página informativa no Guia do usuário. [GitHub-25411](https://github.com/magento/magento2/issues/25411)

### Resenhas

<!-- MC-37117-->

* A página Nova revisão agora é carregada conforme esperado quando você clica no botão **Nova revisão** no Administrador **Marketing** > **Todas as revisões**. Clicar em um produto nesta página abre o novo formulário de revisão esperado para esse produto.

<!-- ENGCOM-8383 -->

* O aplicativo não lança mais este erro quando você tenta editar um pedido do Administrador **Marketing** > **Todas as Avaliações**: `Uncaught TypeError: Event.observe is not a function`.  [GitHub-30388](https://github.com/magento/magento2/issues/30388)

### Vendas

<!-- MC-36219-->

* A coluna `order_created_at` de `sales_shipment_grid` foi atualizada conforme esperado após cada atualização.

<!-- MC-36405-->

* Agora você pode reordenar com êxito um produto com uma data de opções personalizadas de uma loja para a qual o **Usar Calendário do JavaScript** está habilitado. Anteriormente, ao tentar reordenar, o aplicativo não adicionava o item ao carrinho e exibia este erro: `Could not add the product with SKU "simp1" to the shopping cart: Please specify date required option(s).`

<!-- MC-36533-->

* O aplicativo não fecha mais imediatamente um pedido quando um comprador verifica um pedido que consiste em um produto virtual com um custo total de US$ 0 em implantações em que o método de finalização de subtotal zero está habilitado.

<!-- MC-36755-->

* O aplicativo não arquiva mais um pedido antes de processá-lo. Anteriormente, a ação de seleção múltipla na grade Ordem do administrador afetava os pedidos não selecionados.

<!-- MC-37371-->

* A grade do memorando de crédito agora exibe o símbolo de moeda correto quando o Riyal saudita (SAR) é definido como a moeda base.

<!-- MC-37880-->

* O aplicativo agora exibe consistentemente as informações de endereço de entrega conforme esperado na página do pedido durante a finalização da compra.

<!-- MC-38666-->

* O valor de `total_qty` agora corresponde ao valor de `total_qty_ordered` nas faturas de vendas.

<!-- MC-38717-->

* O envio assíncrono de emails de vendas agora envia email apenas para os pedidos que foram criados após a data da última atualização. Anteriormente, o aplicativo não filtrava emails por data quando o envio assíncrono era ativado.

<!-- MC-39135-->

* O aplicativo agora envia um email de fatura conforme esperado quando um pedido é feito pelo administrador.

<!-- MC-38917-->

* O aplicativo agora apaga os dados de pedido existentes durante uma sessão em que um comerciante cria um novo pedido para um cliente do Administrador.

<!-- MC-38915-->

* Agora você pode alterar o grupo de clientes para novos clientes que são criados por meio de uma ordem de Administrador quando a **Habilitar Atribuição automática para o Grupo de clientes** está habilitada. Você também pode atribuir um grupo de clientes com base na validação de IVA. Anteriormente, ao validar o número IVA, o objeto de solicitação não verificava a solicitação atribuída `group_id`. Por padrão, ele usou o padrão `group_id`.

<!-- MC-37539-->

* O aplicativo não altera mais o status de um pedido personalizado com status `Suspected Fraud` para `Processing` depois que um comerciante cria uma remessa parcial usando a API REST.

### Regra de Vendas

<!-- MC-34793-->

* Os códigos de cupom que foram aplicados com base no método de envio não são mais aplicados quando um comprador altera o método de envio. Anteriormente, o aplicativo não limpava os códigos de cupom quando os compradores trocavam de método de envio.

<!-- MC-34649-->

* Os compradores não podem aplicar um código de cupom com mais frequência do que o permitido pela configuração **Usos por cliente**. Anteriormente, se um comprador tivesse várias janelas do navegador abertas e vários pedidos feitos simultaneamente, cada pedido receberia o desconto, mesmo que a configuração **Usos por cliente** tivesse um valor de **1**.

### Pesquisar {#search-heading}

<!-- MC-35095-->

* O Elasticsearch não lança mais um erro de modificador desconhecido quando um comprador pesquisa um sinônimo de pesquisa. Anteriormente, o escapador não tinha um símbolo de barra de escape em expressões regulares, o que resultou em um erro fatal.

<!-- MC-37577-->

* A pesquisa avançada não retorna mais os filhos de produtos configuráveis como resultados de pesquisa individuais quando os produtos filhos foram configurados com visibilidade definida como **Não visível individualmente**.

<!-- MC-37954-->

* A classificação de nomes de produtos Elasticsearch nos resultados de pesquisa não diferencia mais maiúsculas de minúsculas.

<!-- ENGCOM-8329 -->

* A página de resultados da pesquisa agora é armazenada em cache como esperado quando a configuração **definir o Número de resultados de pesquisa principais para armazenar em cache como 0** é habilitada em Admin **Lojas** > **Configuração** > **Catálogo** > **Catálogo** > **Pesquisa de Catálogo**.

<!-- MC-36807-->

* O indexador de pesquisa de catálogo agora é executado sem gerar um erro devido ao limite do campo Elasticsearch. Anteriormente, o aplicativo exibia este erro: `Limit of total fields [xxx] in index [m24dev_product_1_v10] has been exceeded`.

<!-- MC-35491-->

* O desempenho da pesquisa de catálogo melhorou. Desabilitar **Habilitar Sugestões de Pesquisa** (**Lojas** > **Configuração** > **Catálogo** > **Pesquisa de Catálogo** ) funciona conforme esperado. Anteriormente, o aplicativo consultava a tabela `search_query` do MySQL, em vez do Elasticsearch, para obter sugestões de pesquisa de preenchimento automático. [GitHub-25534](https://github.com/magento/magento2/issues/25534)

<!-- MC-35256-->

* O Elasticsearch agora filtra os preços do produto da mesma forma que o MySQL. O tipo de campo `price_*` foi alterado de `float` para `double` no índice Elasticsearch para melhorar a precisão e corrigir um erro de ponto flutuante.

<!-- ENGCOM-8393 -->

* Um ouvinte de eventos de pressionamento de tecla foi adicionado ao Admin para ativar o formulário de pesquisa global quando uma barra é inserida. [GitHub-29551](https://github.com/magento/magento2/issues/29551)

<!-- MC-24217-->

* O Elasticsearch não lança mais um erro, mas não exibe produtos conforme esperado quando um valor `string` é usado para filtrar produtos por atributo com um tipo de back-end `integer` ou `decimal`. Anteriormente, o aplicativo exibia este erro em `exception.log`: `number format exception`.

<!-- ENGCOM-8303 -->

* O Elasticsearch não lança mais uma exceção quando um termo de pesquisa contém um `/`.  [GitHub-25886](https://github.com/magento/magento2/issues/25886), [GitHub-25110](https://github.com/magento/magento2/issues/25110)

* A pesquisa agora está desabilitada conforme esperado para um grupo de clientes selecionado da consulta de produtos quando a configuração **Não permitir Pesquisa de Catálogo por** nas Permissões de Categoria gerais está habilitada. [GitHub-29927](https://github.com/magento/magento2/issues/29927)

<!-- ENGCOM-8466 -->

* Os resultados da pesquisa não incluem mais várias citações da mesma palavra. [GitHub-30104](https://github.com/magento/magento2/issues/30104)

### Envio

<!-- MC-38247 -->

* O processo de finalização não falha mais quando uma interrupção da rede interrompe a conexão com o método de envio da DHL. Em vez disso, o aplicativo exibe outros métodos de envio disponíveis. Anteriormente, o processo de check-out era interrompido quando a conexão com o envio da DHL era interrompida e o aplicativo exibia este erro: `Sorry, no quotes are available for this order at this time`. [GitHub-29902](https://github.com/magento/magento2/issues/29902)

<!-- MC-35194-->

* Os campos que descrevem o método de entrega UPS em Admin **Lojas** > **Configuração** > **Vendas** > **Métodos de Entrega** agora estão habilitados conforme esperado.

<!-- MC-35633-->

* As remessas criadas através do ponto de extremidade `/rest/V1/shipment` do POST agora atualizam os pedidos corretamente. Anteriormente, o aplicativo criava uma remessa, mas o status da remessa permanecia no estado de processamento.

<!-- MC-37120-->

* O aplicativo não remove mais produtos simples do carrinho de compras quando outro produto é removido do carrinho antes do check-out com Enviar para vários endereços. [GitHub-30259](https://github.com/magento/magento2/issues/30259)

<!-- MC-38031-->

* A página Revisão da Ordem agora exibe a quantia de imposto antes da quantia de entrega, conforme esperado para as ordens que estão sendo enviadas para vários endereços.

<!-- ENGCOM-8257 -->

* O rastreamento de remessa UPS agora indica um status de `Delivered On` somente quando um pacote é entregue. [GitHub-30032](https://github.com/magento/magento2/issues/30032)

<!-- MC-38825-->

* O aplicativo agora exibe o subtotal correto do carrinho para pedidos que contêm um produto virtual quando o comprador navega de volta para o carrinho a partir do check-out com vários endereços.

<!-- MC-38682-->

* Os comerciantes agora podem criar uma etiqueta de remessa a partir da página de remessa de um pedido existente que usa envio FedEx quando o agrupamento JavaScript está habilitado. Anteriormente, o aplicativo exibia um erro quando o comerciante clicava no botão **Criar etiqueta de remessa**.

<!-- MC-36953-->

* O link de rastreamento de remessa no email de confirmação de remessa enviado aos clientes agora funciona conforme esperado. Anteriormente, esse link retornava um erro 404.

<!-- ENGCOM-8025 -->

* O aplicativo agora exibe uma mensagem de erro informativa quando um comprador faz o check-out usando vários endereços e, em seguida, remove todos os produtos, exceto um produto virtual. [GitHub-25595](https://github.com/magento/magento2/issues/25595)

<!-- ENGCOM-8253 -->

* Agora você pode criar uma etiqueta de remessa conforme esperado para um pedido parcial. Anteriormente, quando você tentava criar uma etiqueta de remessa para apenas um item de um pedido, o aplicativo adicionava todos os produtos ao pacote e a validação falhava. [GitHub-29552](https://github.com/magento/magento2/issues/29552)

<!-- ENGCOM-8154 -->

* A validação do método de envio não é mais ignorada ao chamar `/V1/guest-carts/:cartId/totals-information`. [GitHub-25147](https://github.com/magento/magento2/issues/25147)

### Mapa do site

<!-- MC-37306-->

* Os mapas de site gerados por `cron` agora incluem URLs de imagem corretas. Anteriormente, o caminho de imagem em cache gerado estava incorreto em implantações de várias lojas.

### Loja

<!-- ENGCOM-7543 -->

* O Admin e o alternador de loja principal agora refletem as alterações feitas na ordem de classificação da loja no Admin. [GitHub-13401](https://github.com/magento/magento2/issues/13401)

<!-- ENGCOM-8274 -->

* O aplicativo agora cria URLs corretos para categorias e produtos depois que a chave de URL de nível superior de uma visualização da loja é alterada. Anteriormente, quando a árvore de categoria de um modo de exibição de armazenamento continha `url_keys` modificado, se uma chave de categoria não fosse alterada, mas a chave dos pais da categoria o fosse, o código original usaria o modo de exibição de repositório padrão da categoria ao criar URLs. [GitHub-28633](https://github.com/magento/magento2/issues/28633)

### Regras do Target

<!-- MC-34998-->

* O carregamento das páginas de detalhes do produto foi otimizado. Adicionamos índices para tabelas de banco de dados que otimizam consultas de condições de regra de destino para muitos casos.

### Imposto

<!-- MC-37666-->

* A validação de IVA em uma ordem de convidado não resulta mais na aplicação salvando a cotação com uma Classe de Imposto do Cliente incorreta. [GitHub-30018](https://github.com/magento/magento2/issues/30018)

<!-- MC-37761-->

* Os pedidos enviados para vários endereços agora podem ser salvos durante o check-out quando o FTP estiver configurado. Anteriormente, após concluir um pedido para vários endereços, o aplicativo exibia uma página em branco em vez da página de sucesso do pedido.

<!-- ENGCOM-8158 -->

* As páginas de detalhes do produto da loja agora exibem preços novos e antigos com e sem impostos, conforme esperado. [GitHub-27500](https://github.com/magento/magento2/issues/27500), [GitHub-11998](https://github.com/magento/magento2/issues/11998)

### Teste

<!-- MC-37364-->

* O `bin/magento dev:tests:run` agora inicia os seguintes testes conforme esperado: all, unit, integration, integration-all, static, static-all, integration, legacy e default.

<!-- MC-38488-->

* `AdminMediaGalleryInsertLargeImageFileSizeTest` foi refatorado.

<!-- ENGCOM-8158 -->

* Os testes de unidade agora são compatíveis com o PHPUnit 8. [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-8009 -->

* `\Magento\TestFramework\TestCase\WebapiAbstract` agora contém uma função que oferece suporte à comparação de matrizes grandes aninhadas de resultados esperados e reais em testes. Chaves irrelevantes no resultado agora podem ser ignoradas. [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-8024 -->

* `AdminMediaGalleryCatalogUiEditCategoryGridPageTest` não falha mais aleatoriamente. [GitHub-1764](https://github.com/magento/adobe-stock-integration/issues/1764)

<!-- ENGCOM-8041 -->

* `dev/tests/integration/testsuite/Magento/Customer/Controller/AccountTest` foi aprimorado. (`assert` agora se baseia no seletor `XPath` em vez de `assertStringContainsString`.) [GitHub-29700](https://github.com/magento/magento2/issues/29700)

<!-- ENGCOM-8017 -->

* Adição de cobertura de teste para o módulo `AdminAnalytics`. [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-8266 -->

* Os testes funcionais de integração e API agora são compatíveis com o PHPUnit 9.3. [GitHub-30146](https://github.com/magento/magento2/issues/30146)

<!-- MC-35798 -->

* Correção de problemas com o teste `testRequestCacheTagsForCategoryListOnMultipleIds` do GraphQL. [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-7762 -->

* Os valores de cabeçalho que incluem URLs agora são analisados corretamente em `ApiFunctional TestFramework`. [GitHub-26425](https://github.com/magento/magento2/issues/26425)

<!-- MC-35798 8109-->

* Correção de problemas com o teste `testRequestCacheTagsForCategoryListOnMultipleIds` do GraphQL. [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-8382 -->

* `—no-tablespaces` foi adicionado a todas as ocorrências de `mysqldump`, o que permite que testes de integração sejam executados sem o privilégio `PROCESS` (necessário desde que MySQL 5.7.31 / 8.0.21 seja executado `mysqldump` por padrão). [GitHub-30566](https://github.com/magento/magento2/issues/30566)

### Tema

<!-- ENGCOM-8419 -->

* Um novo sinalizador `--no-parent` foi adicionado ao comando `bin/magento setup:static-content:deploy` que impede que os pais de um tema sejam compilados. Esse novo sinalizador permite melhorar significativamente o desempenho do processo de implantação de conteúdo estático, evitando compilações desnecessárias. Observe que esse novo sinalizador não funciona ao usar a estratégia `compact`. [GitHub-30184](https://github.com/magento/magento2/issues/30184)

<!-- MC-37630 -->

* A configuração de design não gera mais operações DDL. Anteriormente, quando a configuração de design era atualizada, a aplicação gerava instruções DDL que podiam disparar erros do MySQL.

<!-- ENGCOM-8112 -->

* O código redundante no módulo `Magento_ConfigurableProduct` no tema de Administração foi removido.  [GitHub-29857](https://github.com/magento/magento2/issues/29857)

<!-- ENGCOM-8144 -->

* A navegação por estilos menos redundantes e as propriedades não usadas no tema em branco foram removidas. [GitHub-29914](https://github.com/magento/magento2/issues/29914)

<!-- ENGCOM-8285 -->

* Adição da funcionalidade de navegação recolhível ao Tema em branco na exibição móvel. [GitHub-30237](https://github.com/magento/magento2/issues/30237)

<!-- ENGCOM-7803 -->

* O carregamento de fontes da Web para temas foi otimizado.  [GitHub-29526](https://github.com/magento/magento2/issues/29526)

<!-- ENGCOM-8068 -->

* Os desenvolvedores agora podem especificar o tipo de fonte ao declarar uma fonte personalizada em um tema. [GitHub-29719](https://github.com/magento/magento2/issues/29719)

### Tradução e códigos de idiomas

<!-- MC-36836 -->

* O Seletor de data da grade Pedidos do administrador agora funciona como esperado quando a localidade do administrador é árabe (`ar_SA - Saudi Arabia`).

<!-- MC-38476 -->

* O aplicativo não exibe mais uma mensagem de erro quando um comprador insere um endereço argentino com um código postal válido ao registrar ou adicionar um novo endereço. Anteriormente, o aplicativo exibia este erro: `Provided Zip/Postal Code seems to be invalid. Example: 1234. If you believe it is the right one you can ignore this notice.`

<!-- MC-38663-->

* O aplicativo não emite mais um erro quando um comprador insere um código postal de cinco dígitos para um endereço coreano.

<!-- ENGCOM-8244 -->

* Adição de suporte para as regiões do Uruguai definidas em [ISO 3166-2:UY](https://en.wikipedia.org/wiki/ISO_3166-2:UY). [GitHub-29729](https://github.com/magento/magento2/issues/29729)

<!-- ENGCOM-8220 -->

* `zip_codes.xml` foi atualizado para impor oito dígitos aos códigos postais brasileiros. [GitHub-29984](https://github.com/magento/magento2/issues/29984)

<!-- ENGCOM-8304 -->

* Melhoria na localização das frases não localizadas restantes. [GitHub-11175](https://github.com/magento/magento2/issues/11175)

<!-- ENGCOM-8380 -->

* O espaço reservado de entrada da pesquisa de grade agora pode ser traduzido. [GitHub-30510](https://github.com/magento/magento2/issues/30510)

<!-- ENGCOM-8018 -->

* O aplicativo agora baixa os módulos JavaScript de traduções integradas somente quando estão ativados.  [GitHub-29553](https://github.com/magento/magento2/issues/29553)

### IU

<!-- MC-38509-->

* O botão **Criar uma Conta** na página Criar Nova Conta permanece ativo quando um comprador insere dados inválidos. Anteriormente, esse botão estava desativado, o que impedia os compradores de tentar criar uma conta novamente após cometer um erro. Este foi um problema conhecido na versão 2.4.1. [GitHub-30513](https://github.com/magento/magento2/issues/30513)

<!-- MC-38698-->

* O carregamento da grade de envio na página Admin Order Edit foi aprimorado.

<!-- MC-37870-->

* O aplicativo agora exibe a caixa de seleção **Igual ao endereço de cobrança**, conforme esperado na página do pedido, quando os produtos são adicionados ao carrinho pelo SKU.

<!-- ENGCOM-8007 -->

* A classe CSS que definiu a largura limitada agora é aplicada como esperado aos campos **Hora de Início** no Admin **Armazenamento** > **Configuração** > **Catálogo** > **Mapa do Site XML** > **Configurações de Geração**.  [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992 -->

* Problemas de exibição corrigidos com o rótulo da caixa de seleção dos Termos e condições.  [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7948 -->

* O aplicativo não exibe mais o código CSS para um bloco de preços de camada na página do produto quando os preços de camada não estão disponíveis. [GitHub-29194](https://github.com/magento/magento2/issues/29194)

<!-- ENGCOM-8084 -->

* A posição dos botões na página de detalhes da exibição de imagem foi reordenada para estar em conformidade com as diretrizes da interface do usuário.  [GitHub-1783](https://github.com/magento/adobe-stock-integration/issues/1783)

<!-- ENGCOM-8342 -->

* O campo de texto do código do cupom agora é exibido em largura apropriada nos navegadores Internet Explorer/EDGE.

<!-- ENGCOM-7630 -->

* A variável `@button__border-radius` agora está definida na biblioteca `lib/web/css/source/lib/variables/_buttons.less`.  `border-radius` tem um valor padrão de `3px`. Anteriormente, `border-radius` era codificado.  [GitHub-28674](https://github.com/magento/magento2/issues/28674)

<!-- ENGCOM-8067 -->

* O botão de envio de pesquisa (lupa) no mini campo de pesquisa agora fica desativado até que o comprimento mínimo da sequência de pesquisa seja atingido. [GitHub-29704](https://github.com/magento/magento2/issues/29704)

<!-- MC-38807-->

* O botão **Visualizar Modelo** agora funciona conforme esperado na página Editar Fila.

<!-- MC-31892-->

* O aplicativo agora preserva o valor de um atributo quando você move o atributo de um grupo para outro.

<!-- ENGCOM-8085 -->

* Adição de uma variável de espessura de fonte pesada para `lib/web/css/source/lib/variables/_typography.less`. [GitHub-29778](https://github.com/magento/magento2/issues/29778)

<!-- ENGCOM-8211 -->

* A visibilidade do filtro agora funciona com a visibilidade da coluna, conforme esperado nas grades de administração.  [GitHub-30345](https://github.com/magento/magento2/issues/30345)

<!-- ENGCOM-8152 -->

* As opções do componente de seleção da interface do usuário não ficam mais visíveis quando `this.disabled(true)` é definido. [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7901 -->

* A variável `@font-family-name__base` não é mais usada ao carregar a fonte Open Sans. [GitHub-29515](https://github.com/magento/magento2/issues/29515)

<!-- ENGCOM-8120 -->

* O atributo WAI-ARIA `aria-atomic="true"` foi adicionado à marca do contêiner de erros. [GitHub-29560](https://github.com/magento/magento2/issues/29560)

<!-- ENGCOM-8175 -->

* As grades do componente de interface do usuário agora exibem uma contagem precisa dos itens selecionados. Anteriormente, as grades indicavam um número incorreto de seleções quando uma pesquisa por palavra-chave selecionava todos os itens de grade e o comprador subsequentemente desmarcava alguns itens antes de marcar a caixa de seleção do cabeçalho. [GitHub-29968](https://github.com/magento/magento2/issues/29968)

<!-- ENGCOM-8118 -->

* O aplicativo não exibe mais o HTML não renderizado nas páginas de visão geral de fatura e remessa. [GitHub-29958](https://github.com/magento/magento2/issues/29958)

<!-- ENGCOM-8066 -->

* Clicar em **Opções** em **Lojas** do Administrador > **Taxas de Moeda** agora direciona os usuários para a seção de opções de moeda expandida da página Configuração do sistema. [GitHub-29336](https://github.com/magento/magento2/issues/29336)

<!-- ENGCOM-8361 -->

* Aprimoramento do suporte para exibir um widget dependendo de outra condição para widgets `adminhtml` ao usar um tipo de widget seletor. [GitHub-13316](https://github.com/magento/magento2/issues/13316), [GitHub-7252](https://github.com/magento/magento2/issues/7252), [GitHub-6868](https://github.com/magento/magento2/issues/6868)

<!-- ENGCOM-8336 -->

* Preenchimento de texto aprimorado nas caixas de diálogo pop-up de confirmação no tema Luma. [GitHub-30452](https://github.com/magento/magento2/issues/30452)

### Cofre

<!-- MC-39109-->

* O módulo `Vault` agora reconhece códigos do método de pagamento da solicitação do serviço de gerenciamento de informações de pagamento. Anteriormente, quando um comprador fazia um pedido usando um cartão de crédito Braintree salvo, o aplicativo exibia esse erro mesmo quando um método de pagamento válido era usado: `The requested Payment Method is not available`.

<!-- ENGCOM-7977 -->

* O banner que o aplicativo exibe na página Logon do administrador como cliente agora permanece na parte superior da página quando o usuário rola a tela. [GitHub-29354](https://github.com/magento/magento2/issues/29354)

### Vértice

* As sugestões de endereço agora são removidas conforme esperado quando um endereço é modificado.

* Uma condição de corrida que impedia alguns clientes de salvar o endereço no painel de conta foi resolvida.

* A validação do endereço de vértice não adiciona mais a página Editar endereço ao cache de página inteira em determinadas condições.

* O imposto calculado por vértice agora é considerado quando o frete grátis é configurado para um valor que inclui imposto.

### Estrutura da API da Web

<!-- MC-23904 ENGCOM-8421-->

* Agora você pode usar o POST `V1/invoice/:invoiceId/refund` para reembolsar uma fatura com uma quantidade zero de produtos e encargos de remessa zero (por exemplo, `{"items": [{"qty": 0, "orderItemId": 6, "extensionAttributes": {}}], "appendComment": false, "notify": true, "isOnline": true, "arguments": {"adjustment_negative": 0.0, "adjustment_positive": 0.99, "shipping_amount": 0}}.` ). Anteriormente, o aplicativo exibia este erro: `You can't create a creditmemo without products`. [GitHub-23069](https://github.com/magento/magento2/issues/23069)

<!-- MC-33732 -->

* Agora você pode usar o POST `V1/categories` para criar ou atualizar uma categoria. Anteriormente, o aplicativo não salvava o valor se o valor `default_sort_by` estivesse definido como uma matriz. Quando o valor `default_sort_by` foi definido como uma cadeia de caracteres, o aplicativo emitiu este erro: `Error occurred during \"custom_attributes\" processing. Attribute \"default_sort_by\" has invalid value. The \"string\" value's type is invalid. The \"string[]\" type was expected. Verify and try again.`

<!-- MC-35740 -->

* O uso do POST `V1/invoices/:id/capture` para capturar informações de pagamento agora funciona conforme esperado. Anteriormente, o aplicativo autorizava o pedido, mas o capturava somente no site do gateway de pagamento.

<!-- MC-37794 -->

* Quando você usa o POST `V1/order/:orderId/ship` para criar uma remessa parcial, o ponto de extremidade retorna o número correto de produtos remetidos.

<!-- MC-38425-->

* As faturas criadas usando o POST `V1/order/:orderID/invoice` agora refletem com precisão o pagamento parcial por crédito de loja. Anteriormente, quando um pedido era pago parcialmente com crédito de armazenamento, a fatura era criada sem levar em conta o crédito de armazenamento.

<!-- MC-36830-->

* As chamadas de GET `rest/all/V1/categories` e GET `rest/all/V1/categories?rootCategoryId=2` agora retornam campos `name` e `product_count` preenchidos conforme esperado para todas as categorias na árvore. Anteriormente, os valores do campo de categoria estavam vazios. O plug-in resolvedor de nome de tabela retornou um nome de tabela incorreto para buscar a contagem de produtos por categoria.

<!-- ENGCOM-8286 -->

* O ponto de extremidade `V1/categories/:id` do PUT agora armazena os dados necessários para criar redirecionamentos 301 para chaves de URL de categoria quando o atributo personalizado `save_rewrites_history` é fornecido. [GitHub-29174](https://github.com/magento/magento2/issues/29174), [GitHub-30240](https://github.com/magento/magento2/issues/30240)

### Lista de desejos

<!-- MC-33626-->

* Os compradores agora podem adicionar um produto a uma lista de desejos quando o produto é atribuído a uma origem de estoque personalizada. [GitHub-3018](https://github.com/magento/inventory/issues/3018)

<!-- MC-35416-->

* Agora os administradores podem acessar a página Gerenciar carrinho de compras na página de cliente Admin depois que um cliente adiciona um produto à lista de desejos da loja. Anteriormente, o aplicativo exibia o seguinte erro quando o administrador clicava no botão **Gerenciar carrinho de compras**: `An error has occurred. See error log for details`.

<!-- MC-35573-->

* O botão **Adicionar ao carrinho** na página da lista de desejos compartilhada agora funciona conforme esperado para usuários anônimos, convidados e que não estão conectados.

<!-- ENGCOM-8062 -->

* O aplicativo agora exibe as opções de atributo do produto configuráveis selecionadas na página da lista de desejos, conforme esperado.  [GitHub-24091](https://github.com/magento/magento2/issues/24091), [GitHub-22503](https://github.com/magento/magento2/issues/22503)

<!-- ENGCOM-7779 -->

* `ActionInterface` implementado para `\Magento\Wishlist\Controller\Shared\Allcart`. [GitHub-29537](https://github.com/magento/magento2/issues/29537)

## Problemas conhecidos

**Problema**: o arquivo `[magento_root]/index.php` foi removido, e o aplicativo agora é executado de `/pub` por padrão para configurações do Apache. Os armazenamentos servidos de subpastas não funcionarão como esperado e podem exibir erros 404. **Solução alternativa**: use symlinks para emular a instalação em uma subpasta. O exemplo a seguir usa o `https://shop01.com/shop/` para ilustrar como usar um link simbólico para emular uma instalação em uma subpasta.

1. Criar um subdiretório para `https://shop01.com/shop/`:

   ```bash
   mkdir magento_root/pub/shop01
   ```

   ```bash
   cd magento_root/pub/shop01
   ```

1. Crie symlinks para os diretórios pai do armazenamento no diretório recém-criado:

   ```bash
   ln -s ../media media
   ```

   ```bash
   ln -s ../static static
   ```

   ```bash
   ln -s ../../../pub pub
   ```

   ```bash
   ln -s ../.htaccess .htaccess
   ```

   ```bash
   ln -s ../health_check.php health_check.php
   ```

1. Crie um arquivo `index.php` dentro do novo diretório (`magento_root/pub/shop01/index.php`) e adicione este conteúdo:

```php
   <?php
   require realpath(__DIR__) . '/../../../app/bootstrap.php';

   switch ($_SERVER['HTTP_HOST']) {
       case 'shop01.com':
       case 'www.shop01.com':
           $params = $_SERVER;
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_CODE] = 'shop01';
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_TYPE] = 'website';
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $params);
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
           break;

       default:
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $_SERVER);
           /** @var \Magento\Framework\App\Http $app */
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
       break;
   }
```

1. Configure seu servidor Apache para apontar para o novo subdiretório. As configurações de implantação podem variar bastante. Este é um exemplo de configuração de servidor:

```xml
   <VirtualHost *:80>
       DocumentRoot "magento_root/pub/shop1"
       ServerName shop01.com
   </VirtualHost>
```

**Problema**: o aplicativo não envia as informações de pagamento conforme esperado quando um comprador insere um código correto no campo CAPTCHA na página Pagamento, mas exibe este erro: `There has been an error processing your request`. Isso ocorre somente quando o comprador tenta fazer o pedido sem inserir o código CAPTCHA ou inserindo-o incorretamente.  **Solução alternativa**: atualize a página. <!-- MC-40506-->

**Problema**: o aplicativo cria um pedido no Braintree conforme esperado quando um comprador clica em **Pagar com Venmo**, mas não cria o pedido no Administrador. Consulte o artigo [2.4.2 problema conhecido: o pagamento do Braintree Venmo não funciona](https://support.magento.com/hc/en-us/articles/360054662652/) da Knowledge Base.  <!-- BUNDLE-2894-->

**Problema**: você não pode usar a mutação do GraphQL `addConfigurableProductToCart` para adicionar um produto configurável ao carrinho em uma exibição de loja não padrão em uma implantação de várias lojas que executa o Inventory. (As vitrines da Luma não são afetadas.) o aplicativo exibe este erro: `Could not add item to cart. Please check required options and try again`. **Solução alternativa**: em vez disso, use a mutação `addProductsToCart`. [GitHub-31660](https://github.com/magento/magento2/issues/31660)<!-- PWA-1298-->

## Contribuições da Comunidade

Agradecemos à comunidade mais ampla da Magento Open Source e gostaríamos de reconhecer suas contribuições para esta versão.

A equipe de Engenharia da Comunidade [Magento Contributors](https://magento.biterg.io/app/kibana) mantém uma lista dos principais colaboradores individuais e parceiros por mês, trimestre e ano. Nessa página de Contribuidores, você pode seguir os links para as PRs mescladas no GitHub.

### Contribuições do parceiro

A tabela a seguir destaca as contribuições feitas pelos Parceiros. Esta tabela lista o Parceiro que contribuiu com a solicitação de pull, a solicitação de pull externa e o número do problema do GitHub associado a ela (se disponível).

{{$include /help/_includes/release-notes/engcomm-2-4-2-partner.md}}

### Contribuições individuais do contribuinte

A tabela a seguir identifica as contribuições dos membros da comunidade. Esta tabela lista as solicitações de pull externas, o número do problema do GitHub associado a ela (se disponível) e o membro da comunidade que contribuiu com a solicitação de pull.

{{$include /help/_includes/release-notes/engcomm-2-4-2-issues.md}}

### Requisitos do sistema

Nossa pilha de tecnologia é construída em PHP e MySQL. Para obter mais informações, consulte [Requisitos do Sistema](../../../installation/system-requirements.md).

### Instruções de instalação e atualização

Você pode instalar o Magento Open Source 2.4.2 usando o [Composer](../../../installation/composer.md).

## Kits de ferramentas de migração

A Ferramenta de migração de dados ajuda a transferir dados existentes do armazenamento do Magento 1.x para o Magento 2.x. Essa interface de linha de comando inclui funções de verificação, rastreamento de progresso, registro e teste. Para obter instruções de instalação, consulte [Instalar a Ferramenta de Migração de Dados](../../../tools/data-migration-tool/install.md). Considere explorar ou contribuir para o [repositório de Migração de Dados](https://github.com/magento/data-migration-tool).

O [Kit de Ferramentas de Migração de Código](https://github.com/magento-commerce/code-migration) ajuda a transferir as extensões de armazenamento e personalizações existentes do Magento 1.x para o Magento 2.x. A interface de linha de comando inclui scripts para converter módulos e layouts do Magento 1.x.

<!-- Last updated from includes: 2022-11-04 11:49:04 -->
