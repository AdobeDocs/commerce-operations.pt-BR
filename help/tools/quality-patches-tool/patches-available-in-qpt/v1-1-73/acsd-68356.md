---
title: 'ACSD-68356: [!DNL GraphQL] a consulta de carrinho retorna um valor de desconto incorreto para cotações virtuais'
description: Aplique o patch ACSD-68356 para corrigir o problema do Adobe Commerce em que [!DNL GraphQL] a consulta de carrinho retorna um valor de desconto incorreto para cotações virtuais.
feature: Shopping Cart, GraphQL
role: Admin, Developer
type: Troubleshooting
source-git-commit: de86326804ad0d27b3580d9cede964a59bfa77fe
workflow-type: tm+mt
source-wordcount: '338'
ht-degree: 0%

---

# ACSD-68356: a consulta de carrinho [!DNL GraphQL] retorna um valor de desconto incorreto para cotações virtuais

O patch ACSD-68356 corrige o problema em que a consulta do carrinho de [!DNL GraphQL] retorna um valor de desconto incorreto para cotações virtuais. Este patch está disponível quando o [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73 está instalado. A ID do patch é ACSD-68356. Observe que esse problema está programado para ser corrigido no Adobe Commerce 2.4.9.

## Produtos e versões afetados

**O patch foi criado para a versão do Adobe Commerce:**

* Adobe Commerce (todos os métodos de implantação) 2.4.8-p2

**Compatível com as versões do Adobe Commerce:**

* Adobe Commerce (todos os métodos de implantação) 2.4.8 - 2.4.8-p3

>[!NOTE]
>
>O patch pode se tornar aplicável a outras versões com as novas versões do [!DNL Quality Patches Tool]. Para verificar se o patch é compatível com a sua versão do Adobe Commerce, atualize o pacote `magento/quality-patches` para a versão mais recente e verifique a compatibilidade na [[!DNL Quality Patches Tool]: página Procurar patches](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html). Use a ID do patch como palavra-chave de pesquisa para localizar o patch.

## Problema

[!DNL GraphQL] consultas de carrinho retornam valores de desconto incorretos para cotações virtuais, aplicando descontos a produtos virtuais não qualificados.

<u>Etapas a serem reproduzidas</u>:

1. Crie dois produtos virtuais:
   1. SKU `virtual1`
   1. SKU `virtual2`
1. Criar uma regra de preço de carrinho:
   1. Defina para ser aplicado automaticamente, sem um cupom.
   1. Ações:
   1. Percentual de desconto do preço do produto - 20%.
   1. Aplica-se somente a itens do carrinho em que o SKU é `virtual2`.
1. Adicionar produtos a uma cotação vazia por meio da loja:
   1. Adicione o SKU `virtual1` primeiro.
   1. Adicionar `virtual2` SKU em segundo lugar.
1. Obter detalhes do carrinho usando a seguinte consulta [!DNL GraphQL]:

   ```
   {
     cart(cart_id: "cart_id") {
       email
       itemsV2 {
         total_count
         items {
           uid
           prices {
             total_item_discount {
               value
             }
             price {
               value
             }
             discounts {
               label
               amount {
                 value
               }
             }
           }
           product {
             name
             sku
           }
           quantity
         },
         page_info {
             page_size
             current_page
             total_pages
         }
       }
       applied_coupons {
         code
       }
       prices {
         discounts {
           amount {
             value
           }
           applied_to
           label
         }
         grand_total {
           value
         }
       }
     }
   }
   ```

1. Marque **[!UICONTROL cart]** > **[!UICONTROL items]** > **[!UICONTROL prices]** > **[!UICONTROL discounts]**.

<u>Resultados esperados</u>:

* `virtual1` SKU não tem desconto listado em [!DNL GraphQL]
* `virtual2` SKU tem desconto listado em [!DNL GraphQL]

<u>Resultados reais</u>:

* `virtual1` e `virtual2` mostram incorretamente o mesmo valor de desconto na resposta [!DNL GraphQL].

## Aplicar o patch

Para aplicar patches individuais, use os links a seguir, dependendo do método de implantação:

* Adobe Commerce ou Magento Open Source local: [[!DNL Quality Patches Tool] > Uso](/help/tools/quality-patches-tool/usage.md) no guia [!DNL Quality Patches Tool].
* Adobe Commerce na infraestrutura em nuvem: [Atualizações e patches > Aplicar patches](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html) no guia do Commerce na infraestrutura em nuvem.

## Leitura relacionada

Para saber mais sobre [!DNL Quality Patches Tool], consulte:

* [[!DNL Quality Patches Tool]: uma ferramenta de autoatendimento para patches de qualidade](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) no guia Ferramentas.
